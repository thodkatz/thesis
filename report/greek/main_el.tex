% !TEX program = xelatex

\documentclass[12pt, a4paper]{article}

\usepackage{fontspec}
\setmainfont[Ligatures=TeX]{Linux Libertine O}
\usepackage[left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm]{geometry}

\usepackage{xcolor}
\definecolor{DarkGreen}{rgb}{0.0, 0.5, 0.0}
\definecolor{DarkBlue}{rgb}{0.0, 0.0, 0.55}
\usepackage[colorlinks]{hyperref}
\hypersetup{
	colorlinks = true,
%	pdfborder = {0 0 0},
	citecolor = DarkGreen,
	linkcolor = DarkBlue,
	urlcolor = DarkGreen,
}

\usepackage{amsmath,amsfonts,amssymb}


\usepackage{dirtytalk}
\usepackage{bookmark}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{color}
\usepackage{indentfirst}
\usepackage{cleveref}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{wrapfig}

\usepackage[acronym]{glossaries}
\makeglossaries

\usepackage{subcaption}
\renewcommand*{\thesubfigure}{\roman{subfigure}}

\renewcommand{\figurename}{Σχήμα}
\renewcommand{\tablename}{Πίνακας}
\crefname{section}{Κεφάλαιο}{Κεφάλαια}
\crefname{table}{Πίνακας}{Πίνακες}
\crefname{figure}{Σχήμα}{Σχήματα}
\newcommand{\crefwithname}[1]{\cref{#1}: \nameref{#1}}
\newcommand{\crefwithappendix}[1]{Παράρτημα: \nameref{#1}}


\graphicspath{{../assets/}}

\sloppy

\renewcommand*{\glspostdescription}{}  % removes the full stop


\usepackage{setspace}
\onehalfspacing % 1.5 line spacing

\begin{document}

\include{cover_el}

% \title{Τίτλος διπλωματικής}
% \author{Όνομα Επίθετο \\
% \href{mailto:empty@auth.gr}{empty@auth.gr}}
% \maketitle


% \begin{center}
% \textbf{\Large Acknowledgements}
% \end{center}


% \clearpage



\clearpage
\phantomsection
\addcontentsline{toc}{subsection}{Περίληψη}
\noindent
\textbf{\Large Περίληψη}
\newline

\noindent
Οι προηγμένες μονοκυτταρικές τεχνολογίες έχουν δημιουργήσει νέες προοπτικές για την κατανόηση και αξιοποίηση των κυτταρικών αποκρίσεων σε διαταραχές, οι οποίες έχουν σημαντικές εφαρμογές στο πεδίο της βιοϊατρικής. Ωστόσο, η εγγενής πολυπλοκότητα των βιολογικών συστημάτων και οι τεχνικοί περιορισμοί των πειραματικών πρωτοκόλλων δημιουργούν προκλήσεις για πολλές από τις προτεινόμενες υπολογιστικές μεθόδους, δυσχεραίνοντας την αλγοριθμική ανάπτυξη των μηχανισμών διαταραχής. Η μάθηση πολλαπλών εργασιών αποτελεί μία από τις προσεγγίσεις βαθιάς μάθησης που παραμένουν ανεξερεύνητες σε αυτό το ερευνητικό πεδίο.
Στην παρούσα μελέτη επιδιώκουμε να καλύψουμε αυτό το κενό, εξετάζοντας την προοπτική της προσέγγισης αυτής στη μοντελοποίηση μονοκυτταρικών διαταραχών. Για τον σκοπό αυτόν, αναπτύξαμε μια πρωτότυπη αρχιτεκτονική autoencoder πολλαπλών εργασιών, η οποία  έχει τη δυνατότητα να προβλέπει μονοκυτταρικά μεταγραφωμικά προφίλ για ένα σύνολο από διαταραχές, εφαρμόζοντας μία από αυτές. Με τον τρόπο αυτόν διαπιστώσαμε ότι επιτυγχάνει αποτελέσματα αιχμής, ενώ ταυτόχρονα επιδεικνύει μεγαλύτερη επεκτασιμότητα και αποδοτικότητα σε σύγκριση με τις υπάρχουσες μεθόδους. Ιδιαιτέρως ενδιαφέρουσα κατεύθυνση για τη μελλοντική έρευνα είναι η περαιτέρω διαμόρφωση της αρχιτεκτονικής αυτής ως θεωρητικού και αφηρημένου μοντέλου, το οποίο θα στοχεύει στην ταυτόχρονη επίλυση πολλαπλών συναφών προβλημάτων στο πεδίο της μοντελοποίησης διαταραχών και της βιοπληροφορικής ευρύτερα.

\vspace{1cm}
\noindent
\textbf{\Large Λέξεις κλειδιά}
\newline

\noindent
Μονοκυτταρική τεχνολογία, διαταραχή, μοντελοποίηση διαταραχής, μάθηση πολλαπλών εργασιών, autoencoder, βαθιά μάθηση


\clearpage


\begin{center}
    \large Thesis Title
    \begin{Large}
    \noindent

    \textbf{Multi-task learning in perturbation modeling}

    \textbf{with application to single-cell data}  
\end{Large}    
\end{center}
    


\vspace{50pt}

\phantomsection
\addcontentsline{toc}{subsection}{Abstract}
\noindent
\textbf{\Large Abstract}
\newline


\noindent
Advanced single-cell technologies have provided new insights for the comprehension and utilization of cellular responses to perturbations, with significant potential for biomedicine. However, the inherent complexity of biological systems and the technical limitations of the experimental protocols present challenges for many proposed computational methods to algorithmically capture the perturbation mechanisms. Multi-task learning is one of the methods that have been left unexplored in this field. In this study, we aim to bridge this gap by unraveling its potential in single-cell perturbation modeling. We have developed a multi-task autoencoder architecture that predicts perturbed single-cell transcriptomic profiles for multiple perturbations. This method achieves state-of-the-art performance while exhibiting greater scalability and efficiency compared to existing methods. Further investigation and refinement of this architecture as a theoretical and abstract model for simultaneously solving multiple related problems in perturbation modeling and broader bioinformatics would be of particular interest.

\vspace{1cm}
\noindent
\textbf{\Large Keywords}
\newline

\noindent
Single-cell technology, perturbation, perturbation modeling, multi-task learning, autoencoder, deep learning


\vspace{60pt}


\begin{center}
    \begin{large}
    Theodoros Katzalis
    \end{large}

    thodkatz@gmail.com

    \vspace{\baselineskip}

    Department of Electrical and Computer Engineering
    
    Aristotle University of Thessaloniki, 54124 Thessaloniki, Greece

    \vspace{\fill}

    Thessaloniki, December 2025

\end{center}


\clearpage
\phantomsection
\addcontentsline{toc}{subsection}{Ευχαριστίες}
\noindent
\textbf{\Large Ευχαριστίες}
\newline


Καταρχάς, θα ήθελα να ευχαριστήσω θερμά τον επιβλέποντα Καθηγητή, κ. Περικλή Μήτκα, για την ευκαιρία που μου έδωσε να συνεργαστώ μαζί του και να εκπονήσω την εργασία μου σε αυτό το ενδιαφέρον ερευνητικό πεδίο υπό την επιστημονική καθοδήγηση και υποστήριξή του. Η συνεργασία μου μαζί του διεύρυνε σημαντικά τους ορίζοντές μου και μου έδωσε τη δυνατότητα να ανακαλύψω μια μοναδική σύνθεση ανάμεσα στη βιολογία και τη μηχανική, επεκτείνοντας το πρόγραμμα σπουδών, η οποία και κέντρισε το ενδιαφέρον μου, και με ενέπνευσε να συνεχίσω την ενασχόλησή μου με αυτό το εξελισσόμενο διεπιστημονικό πεδίο.

Εγκάρδιες ευχαριστίες οφείλω επίσης στην ομάδα βιοπληροφορικής του Ινστιτούτου Εφαρμοσμένων Βιοεπιστημών (ΙΝΕΒ) του Εθνικού Κέντρου Έρευνας και Τεχνολογικής Ανάπτυξης (ΕΚΕΤΑ), και συγκεκριμένα στον επιβλέποντα της ομάδας κ. Φώτη Ε. Ψωμόπουλο, και στα μέλη Γεώργιο Γαβριηλίδη, Βασίλειο Βασιλείου και Άσπα Ορφανού. Η ομάδα με εισήγαγε στον χώρο της βιοπληροφορικής και με στήριξε πολυεπίπεδα καθ´όλη τη διάρκεια εκπόνησης της εργασίας μου, παρέχοντας τεχνογνωσία και χρόνο για εποικοδομητικές συζητήσεις, οι οποίες βοήθησαν αμέριστα τον προσανατολισμό της έρευνάς μου.

Θα ήθελα να αναφέρω επιπλέον ότι η εκπόνηση της εργασίας μου θα ήταν ανέφικτη δίχως την πρόσβαση στους υπολογιστικούς πόρους του Ευρωπαϊκού Εργαστηρίου Μοριακής Βιολογίας (EMBL) της Χαϊδελβέργης. Για αυτό θα ήθελα να ευχαριστήσω θερμά την κ. Anna Kreshuk, επικεφαλής της ομάδας ανάλυσης βιολογικών εικόνων με τη χρήση τεχνητής νοημοσύνης (Machine learning for bioimage analysis), για τη δυνατότητα που μου έδωσε να αποτελώ μέλος της ομάδας της ως μηχανικός λογισμικού για την πλατφόρμα ilastik\footnote{\url{https://www.ilastik.org/}}, και παράλληλα να έχω πρόσβαση στη συστοιχία υπολογιστών του Εργαστηρίου για την επιτέλεση των πειραμάτων μου.

Τέλος, νιώθω την ανάγκη να ευχαριστήσω την οικογένειά μου και τους φίλους μου για τη συναισθηματική υποστήριξη που μου παρείχαν καθ'όλη τη διάρκεια της ερευνητικής μου πορείας στην Ελλάδα και το εξωτερικό.

\clearpage

{
\renewcommand*\contentsname{Περιεχόμενα}
%\hypersetup{linkcolor=black}
\tableofcontents
}

\thispagestyle{empty}

\clearpage
\phantomsection
\addcontentsline{toc}{subsection}{Κατάλογος Σχημάτων}
\renewcommand{\listfigurename}{Κατάλογος Σχημάτων}
\listoffigures

\clearpage
\phantomsection
\addcontentsline{toc}{subsection}{Κατάλογος Πινάκων}
\renewcommand{\listtablename}{Κατάλογος Πινάκων}
\listoftables


\clearpage
\phantomsection
\addcontentsline{toc}{subsection}{Ακρωνύμια}
\include{acronyms}
\printglossary[type=\acronymtype, title=Ακρωνύμια]
\clearpage

\include{glossaries}

\glsunsetall[\acronymtype]


% I have mentioned that scvidr is a \gls{mlt} model. Thus, maybe I have to rephrase it since there were some attempts but not fully dedicated to explore the \gls{mlt} as a learning paradigm per se.

\section{Εισαγωγή}


Η εφαρμογή των αρχών και των τεχνικών της επιστήμης των υπολογιστών αποτελεί πλέον αναπόσπαστο κομμάτι της βιολογικής έρευνας. Η βιοπληροφορική, πεδίο που χαρακτηρίζεται από τη χρήση υπολογιστικών μεθόδων και την κατασκευή εργαλείων για τη μελέτη και την ανάλυση βιολογικών δεδομένων, ξεκίνησε ήδη από τη δεκαετία του 1960 με αφετηρία την ανάλυση πρωτεϊνικών αλληλουχιών. Στη σύγχρονη εποχή, χάρη στην τεχνολογική πρόοδο και την ανάπτυξη της τεχνολογίας "αλληλούχιση επόμενης γενιάς" (\glslink{ngs}{Next-Generation Sequencing - NGS}) \cite{gauthier2019brief}, το πεδίο έχει επεκταθεί ώστε να περιλαμβάνει ακόμη και την αλληλούχιση γενετικού υλικού σε μονοκυτταρικό επίπεδο και σε μεγάλη κλίμακα. Έτσι, η μηχανική μάθηση βρίσκει πρόσφορο έδαφος για την ανάπτυξη αλγορίθμων που μπορούν να αναλύσουν και να ερμηνεύσουν τα τεράστια αυτά σύνολα δεδομένων \cite{libbrecht2015machine}.

\subsection{Συνοπτική περιγραφή του προβλήματος}

Η εμφάνιση των μονοκυτταρικών τεχνολογιών έχει καταστήσει δυνατή τη μελέτη της βιολογικής ετερογένειας σε κυτταρική ανάλυση, ανοίγοντας νέους δρόμους για την κατανόηση των κυτταρικών μηχανισμών και των αποκρίσεών τους σε διαταραχές.
Ωστόσο, ο χώρος των διαταραχών είναι πολυδιάστατος, και η διερεύνηση όλων των πιθανών συνδυασμών θα ήταν ανέφικτη εξαιτίας του χρονοβόρου και δαπανηρού εργαστηριακού πειραματισμού \cite{heumos2023best, kana2023generative}.
Αυτό έχει οδηγήσει στην ανάπτυξη υπολογιστικών μεθόδων για τη μοντελοποίηση του χώρου αυτού, επιτρέποντας την εξαγωγή συμπερασμάτων σε καινούρια ψηφιακά σενάρια. Έτσι επιτυγχάνεται ο λεγόμενος in silico πειραματισμός, ο οποίος προσομοιώνει τον εργαστηριακό.
Το πεδίο που ασχολείται με την αποκωδικοποίηση και την πρόβλεψη των επιδράσεων εξωτερικών ερεθισμάτων (gene knockouts, δοσολογίες φαρμάκων, μεταβολές θερμοκρασίας κ.ά.) αναφέρεται ως \gls{perrbmodel} (perturbation modeling), και διαδραματίζει κρίσιμο ρόλο στην ανακάλυψη μηχανισμών ασθενειών και στον εντοπισμό θεραπευτικών στόχων (therapeutic target identification) \cite{jiMachineLearningPerturbational2021}.


\clearpage

\subsection{Στόχος διπλωματικής}

Η πολυπλοκότητα της βιολογικής απόκρισης σε διαταραχές μπορεί να αναλυθεί σε επιμέρους, σχετικούς στόχους για την απλοποίηση και την καλύτερη κατανόηση της διαδικασίας.
H \gls{multitasklearning} (\gls{mlt}) είναι μία τεχνική μηχανικής μάθησης, η οποία θα μπορούσε να αξιοποιήσει αυτήν την αποδόμηση, καθώς επιτρέπει την ταυτόχρονη εκμάθηση πολλαπλών σχετικών εργασιών, ενισχύοντας τη γενίκευση και την απόδοση μέσω της κοινής χρήσης αναπαραστάσεων \cite{ruderOverviewMultiTaskLearning2017}.
Έτσι, αυτή η τεχνική μπορεί να είναι μια πολλά υποσχόμενη προσέγγιση για την αντιμετώπιση των προκλήσεων που παρουσιάζονται στη μοντελοποίηση μονοκυτταρικών διαταραχών.
Ωστόσο, παρά τα πλεονεκτήματα που προσφέρει, η εφαρμογή της σε αυτό το πεδίο παραμένει ανεξερεύνητη. Στην παρούσα εργασία, επιδιώκουμε να καλύψουμε αυτό το κενό, εξετάζοντας την προοπτική της.


\subsection{Μεθοδολογία}

Αρχικά επιχειρήσαμε να διερευνήσουμε ποιες εργασίες μπορούν να προκύψουν από το γενικευμένο πρόβλημα της μοντελοποίησης διαταραχών, ώστε να αξιοποιηθεί η μάθηση πολλαπλών εργασιών. Στη συνέχεια, εστιάσαμε σε εφαρμογές μονοκυτταρικών δεδομένων, και συγκεκριμένα στην πρόβλεψη γονιδιακής έκφρασης μετά από μια διαταραχή (\gls{ood}).

Για να αξιοποιήσουμε την τεχνική της μάθησης πολλαπλών εργασιών, αναπτύξαμε μια πρωτότυπη αρχιτεκτονική \gls{mlt} autoencoder, η οποία έχει τη δυνατότητα να προβλέπει μονοκυτταρικά μεταγραφωμικά προφίλ (\gls{sc}) για ένα σύνολο από διαταραχές, εφαρμόζοντας μία από αυτές. Η διαταραχή μοντελοποιήθηκε ως ένα διάνυσμα, το οποίο κωδικοποιεί τον τύπο της διαταραχής και ενσωματώνεται στην αρχιτεκτονική του autoencoder μέσω \glslink{filmlayers}{FiLM επιπέδων} \cite{dumoulin2018feature-wise}. H μέθοδος \gls{film} αποτελεί έναν τύπο αθροιστικού και πολλαπλασιαστικού μετασχηματισμού που εφαρμόζεται σε κάθε κόμβο του επιπέδου του δικτύου που μας ενδιαφέρει.

Η αρχιτεκτονική αξιολογήθηκε για τρία διαφορετικά σενάρια πρόβλεψης διαταραγμένων μονοκυτταρικών μεταγραφωμικών προφίλ, και συγκρίθηκε με αντίστοιχες μεθόδους της βιβλιογραφίας. Αρχικά, εξετάστηκε η απόδοση σε περίπτωση μονής διαταραχής, της ιντερφερόνης βήτα (\gls{ifnb}), σε ανθρώπινα μονοπύρηνα κύτταρα περιφερικού αίματος (\gls{pbmc}) \cite{kanaGenerativeModelingSinglecell2023}. Στη συνέχεια, η αρχιτεκτονική αξιολογήθηκε στην περίπτωση πολλαπλών διαταραχών σε ποντίκια, μέσω της εφαρμογής της χημικής ουσίας 2,3,7,8 τετραχλωρο-διβενζο-παρα-διοξίνη (\gls{tcdd}) σε διαφορετικές δοσολογίες \cite{nault2021single,nault2022benchmarking}. Τέλος, έγινε εξέταση του σεναρίου εφαρμογής μονής διαταραχής, του λιποπολυσακχαρίτη (\gls{lps}), μεταξύ διαφορετικών ειδών (ποντίκι, λαγός, αρουραίος, χοίρος) \cite{hagai2018gene}, εισάγοντας έναν επιπλέον άξονα μεταβλητότητας ως προς το είδος, ο οποίος επεκτείνει τα προηγούμενα σενάρια μελέτης μεταγραφωμικής υπό διέγερση.


\subsection{Διάρθρωση}

Η εργασία αποτελείται από πέντε κεφάλαια. Μετά την εισαγωγή (Κεφάλαιο 1) παρουσιάζεται το θεωρητικό υπόβαθρο της εργασίας  (Κεφάλαιο 2). Σε αυτό αναλύουμε τις τεχνικές προκλήσεις στον χώρο της μοντελοποίησης διαταραχών μονοκυτταρικού επιπέδου και τις προσεγγίσεις της βιβλιογραφίας για την αντιμετώπιση αυτών. Επιπλέον, περιλαμβάνουμε τη βασική θεωρία της μάθησης πολλαπλών εργασιών και τους πιθανούς τρόπους εφαρμογής της στη μοριακή βιολογία. Στο κεφάλαιο 3 καταλήγουμε μεθοδολογικά στο πεδίο της πρόβλεψης εκτός κατανομής (\gls{ood}), στο οποίο επιχειρούμε να αξιοποιήσουμε την προσέγγιση της μάθησης πολλαπλών εργασιών, και περιγράφουμε την κύρια \gls{mlt} αρχιτεκτονική που αναπτύξαμε και διάφορες παραλλαγές της. Στο κεφάλαιο 4 παρουσιάζουμε και αναλύουμε τα αποτελέσματα των πειραμάτων μεταξύ των \gls{mlt} προσεγγίσεων και των μεθόδων αιχμής (\gls{sota}) της βιβλιογραφίας. Τέλος, στο κεφάλαιο 5 διατυπώνουμε τα συμπεράσματα της συνολικής ερευνητικής διαδικασίας, καθώς και τους στόχους της μελλοντικής έρευνας στο πεδίο. Ακολουθεί η διαθεσιμότητα του κώδικα που αναπτύξαμε, το Παράρτημα, και το γλωσσάρι της εργασίας.
% παράρτημα

\clearpage

\section{Θεωρητικό υπόβαθρο}

Η τεχνολογική πρόοδος στον χώρο της αλληλούχισης γενετικού υλικού, και συγκεκριμένα η μέθοδος "αλληλούχιση επόμενης γενιάς" (\glslink{ngs}{Next Generation Sequencing - NGS}), ανέδειξε δύο βασικές προσεγγίσεις ανίχνευσης των γονιδιακών εκφράσεων σε ένα βιολογικό δείγμα. Η πρώτη, ονόματι bulk RNA-seq, έχει τη δυνατότητα να μετρήσει το μεταγράφωμα (\glslink{transcriptome}{transcriptome}) σε ένα πληθυσμό κυττάρων, καταγράφοντας μια μέση απόκριση της γονιδιακής έκφρασης. Από την άλλη πλευρά, η δεύτερη προσέγγιση, γνωστή ως μονοκυτταρική (\gls{sc}), εστιάζει στη γονιδιακή έκφραση του κάθε κυττάρου, με αποτέλεσμα να διευρύνει τη μεταγραφωμική ευκρίνεια και να φανερώνει την κυτταρική ετερογένεια. Με αυτόν τον τρόπο, η μονοκυτταρική τεχνολογία έχει τη δυνατότητα να φανερώσει κυτταρικές αποκρίσεις που μπορεί να είναι καίριας σημασίας, χωρίς αυτή η πληροφορία να χάνεται σε υπολογισμούς μέσων τιμών, όπως συμβαίνει με την bulk RNA-seq μέθοδο \cite{10xBulkVsSingleCell2025}.

\begin{figure}[h!]
    \centering
    \includegraphics[width=.8\textwidth]{bulk_vs_single.png}
    \caption{Σύγκριση τεχνολογιών αλληλούχισης single cell RNA-seq και bulk RNA-seq\cite{mbzuai2024future}}
\end{figure}

Ωστόσο, οι εγγενείς περιορισμοί των τεχνολογιών συντελούν στη δημιουργία συνόλων δεδομένων μοντελοποίησης διαταραχών με θορυβώδη και αραιά (sparse) χαρακτηριστικά.  
Για παράδειγμα, είναι πιθανό να προκύψουν φαινόμενα dropout, οδηγώντας σε μεγάλο αριθμό μηδενικών τιμών στα προφίλ έκφρασης, ως αποτέλεσμα της αδυναμίας ανίχνευσης χαμηλών επιπέδων γονιδιακής έκφρασης. Επιπλέον, τα δεδομένα είναι υψηλής διαστασιμότητας, αποτελούμενα συνήθως από χιλιάδες κύτταρα που έχουν μελετηθεί ως προς εκατοντάδες ή και χιλιάδες χαρακτηριστικά (π.χ. επίπεδα γονιδιακής έκφρασης στη μεταγραφωμική), γεγονός που επιτρέπει λεπτομερή ανάλυση των κυτταρικών αποκρίσεων \cite{jiMachineLearningPerturbational2021}. Η ίδια η απόκριση στις διαταραχές είναι μη-γραμμική και περίπλοκη, εξαρτώμενη όχι μόνο από τη φύση της διαταραχής, αλλά και από το κυτταρικό περιβάλλον, συμπεριλαμβανομένου του τύπου κυττάρου, του μικροπεριβάλλοντος, του γενετικού υποβάθρου και της χρονικής δυναμικής \cite{gavriilidis2024mini}.

Οι μέθοδοι μηχανικής μάθησης, ιδίως η βαθιά μάθηση (deep learning), έχουν δείξει σημαντικές δυνατότητες στην αντιμετώπιση αυτής της πολυπλοκότητας, αξιοποιώντας τη γενετική τους ικανότητα, η οποία καθίσταται εφικτή χάρη στη ραγδαία αύξηση των μονοκυτταρικών δεδομένων υψηλής απόδοσης (high-throughput) \cite{gavriilidis2024mini}. Πιο συγκεκριμένα, υπάρχει αυξανόμενο ενδιαφέρον για την αξιοποίηση των μεγάλων γλωσσικών μοντέλων (\gls{llm}) στον τομέα αυτό. Μια πρόσφατη επισκόπηση από τους Szalata et al. \cite{szalata2024transformers} υπογραμμίζει αυτήν την προσέγγιση ως μια πολλά υποσχόμενη, αν και ακόμη ανώριμη, ερευνητική κατεύθυνση. Τα κύρια προβλήματα περιλαμβάνουν την απουσία τυποποιημένων πλαισίων αξιολόγησης, αστάθειες στα μοντέλα, ανεπαρκώς ποικιλόμορφα σύνολα δεδομένων και την έλλειψη διαδοχικής δομής ανάλογης με τις αναπαραστάσεις θέσης (positional embeddings) που χρησιμοποιούνται στην επεξεργασία φυσικής γλώσσας.
Αντίθετα, οι αρχιτεκτονικές autoencoders και οι παραλλαγές τους έχουν ήδη επιδείξει ισχυρές επιδόσεις, ξεπερνώντας τους transformers \cite{szalata2024transformers}, ενώ προσφέρουν σημαντικά πλεονεκτήματα όσον αφορά την αποδοτικότητα πόρων και τη μειωμένη υπολογιστική πολυπλοκότητα.

Βασιζόμενες στην κεντρική αρχή της βαθιάς μάθησης, γνωστή ως manifold hypothesis, οι αρχιτεκτονικές autoencoder στοχεύουν στην εκμάθηση μιας αναπαράστασης των δεδομένων σε μικρό αριθμό διαστάσεων που αποτυπώνει τη θεμελιώδη δομή της απόκρισης στη διαταραχή. Αυτό επιτυγχάνεται μέσω της αρχιτεκτονικής \glslink{encoder}{κωδικοποιητή}-\glslink{decoder}{αποκωδικοποιητή} (encoder–decoder), όπου ο κωδικοποιητής συμπιέζει τα δεδομένα εισόδου σε χώρο μικρότερης διάστασης, ενώ ο αποκωδικοποιητής επιχειρεί να ανακατασκευάσει τα αρχικά δεδομένα \cite{hinton2006reducing}. Αυτή η συμπίεση μπορεί να παράγει βιολογικά σημαντικά χαρακτηριστικά, οδηγώντας σε πιο ερμηνεύσιμη και αποδοτική αναπαράσταση των δεδομένων, χρήσιμη για επακόλουθες εργασίες, όπως η ανίχνευση αποκρίσεων εκτός του χώρου παρατήρησης (\gls{ood}) \cite{gavriilidis2024mini}.

Ωστόσο, η μη-γραμμικότητα των μοντέλων βαθιάς μάθησης παρουσιάζει μια επιπλέον πρόκληση όσον αφορά την ισορροπία μεταξύ ακρίβειας πρόβλεψης και ερμηνευσιμότητας \cite{kana2023generative}. Αυτή η αντιστάθμιση παραμένει κομβικό σημείο για το πεδίο, και πολλές πρόσφατες προσπάθειες στοχεύουν στην αντιμετώπισή της μέσω αιτιοκρατικών προσεγγίσεων μηχανικής μάθησης, όπως τα GRouNdGAN, sVAE+ και graphVCI \cite{gavriilidis2024mini}. Άλλες ερμηνεύσιμες προσεγγίσεις περιλαμβάνουν τη χρήση τιμών SHAP από το UnitedNet \cite{tangExplainableMultitaskLearning2023}, integrated gradients από το PerturbNet \cite{yuPerturbNetPredictsSinglecell2022}, καθώς και την προσέγγιση της συνάρτησης του μη-ερμηνεύσιμου μη-γραμμικού αποκωδικοποιητή μέσω sparse ridge regression, όπως παρουσιάζεται στο scVIDR \cite{kanaGenerativeModelingSinglecell2023}.

Επιπλέον περιορισμοί στα δεδομένα, όπως οι επιδράσεις παρτίδας (batch effects) και οι συγχυτικοί παράγοντες (confounding covariates), επηρεάζουν επίσης την ακρίβεια πρόβλεψης. Για την αντιμετώπιση αυτών των ζητημάτων και τη βελτίωση της γενίκευσης, πρόσφατες μελέτες επικεντρώνονται σε ολοκληρωμένη μονοκυτταρική ομική ανάλυση (integrative single-cell omics), συμπεριλαμβανομένης της ενσωμάτωσης χωρικών δεδομένων (spatial omics). Ο στόχος είναι η εκμάθηση μιας αναπαράστασης με μικρό αριθμό διαστάσεων που απομονώνει το ουσιώδες βιολογικό πλαίσιο, απαλλάσσοντάς το από τεχνικές διαφοροποιήσεις.

\subsection{Μάθηση πολλαπλών εργασιών (Multi-task learning)}
\label{sec:mlt}

Η μάθηση πολλαπλών εργασιών (\gls{mlt}) αποτελεί ένα πρότυπο μηχανικής μάθησης, στο οποίο ένα ενιαίο μοντέλο εκπαιδεύεται, ώστε να εκτελεί ταυτόχρονα πολλαπλές, σχετικές μεταξύ τους εργασίες. Η κεντρική ιδέα είναι ότι, μέσω της κοινής χρήσης αναπαραστάσεων μεταξύ των εργασιών, το μοντέλο μπορεί να γενικεύσει καλύτερα σε σύγκριση με το αν εκπαιδεύονταν με βάση την κάθε εργασία ξεχωριστά. Η προσέγγιση αυτή αντλεί έμπνευση από τη μάθηση και τη γνωστική λειτουργία του ανθρώπου, όπου η αναλογία παίζει κεντρικό ρόλο στη μεταφορά γνώσης μεταξύ διαφορετικών γνωστικών περιοχών \cite{hofstadter2001analogy, zhangSurveyMultiTaskLearning2021}.
Από τη σκοπιά της μηχανικής μάθησης, μπορούμε να τη θεωρήσουμε ως μια μορφή επαγωγικής προκατάληψης (inductive bias). Συγκεκριμένα, η τεχνική αυτή κατευθύνει το μοντέλο να προτιμά υποθέσεις που εξηγούν περισσότερες από μία εργασίες, όπως παρόμοια συμβαίνει με την L1 κανονικοποίηση, η οποία οδηγεί σε προτίμηση για αραιές λύσεις \cite{ruderOverviewMultiTaskLearning2017}. Η αποτελεσματικότητα της μεθόδου εξαρτάται από τη σχέση μεταξύ των εργασιών. Όταν οι εργασίες δεν είναι στενά συνδεδεμένες, μπορεί να προκύψει αρνητική μεταφορά (negative transfer), κατά την οποία η μάθηση μιας εργασίας επιδρά αρνητικά στην επίδοση μιας άλλης \cite{standleyWhichTasksShould2020}. Συνεπώς, η κατανόηση των σχέσεων μεταξύ των εργασιών και ο σχεδιασμός κατάλληλων κοινών αρχιτεκτονικών αποτελούν κρίσιμους παράγοντες για την επιτυχία της \gls{mlt}.

Ένα από τα αρχικά κίνητρα της μάθησης πολλαπλών εργασιών είναι η έμμεση αύξηση δεδομένων (implicit data augmentation) μέσω του συνδυασμού πηγών πληροφορίας από διαφορετικές εργασίες, ώστε να διευθετηθεί το ζήτημα της έλλειψης δεδομένων (data scarcity). Αυτό είναι ιδιαίτερα σχετικό στα μονοκυτταρικά πρωτόκολλα πολυ-ομικής (single-cell multi-omics), όπου τα δεδομένα είναι περιορισμένα λόγω της πολυπλοκότητας και του κόστους των πειραματικών διαδικασιών. Παρόμοια οφέλη παρατηρούνται και στα μονοκυτταρικά σύνολα δεδομένων μίας τροπικότητας (single-cell single modality), όπου τα δεδομένα είναι περιορισμένα για συγκεκριμένο αριθμό διαταραχών \cite{caoScButterflyVersatileSinglecell2024}.

Άλλα πλεονεκτήματα της \gls{mlt} περιλαμβάνουν την πρόληψη της υπερεκπαίδευσης (overfitting) και τη μείωση του θορύβου των δεδομένων της κάθε εργασίας. Ο θόρυβος μπορεί να αποκρύψει τα υποκείμενα πρότυπα, καθιστώντας δύσκολη τη μάθηση ουσιαστικών αναπαραστάσεων. Ο συνδυασμός δεδομένων από πολλαπλές εργασίες παρέχει πρόσθετα στοιχεία, επιτρέποντας στο μοντέλο να διακρίνει τα σημαντικά χαρακτηριστικά, οδηγώντας έτσι σε πιο ανθεκτικά και γενικεύσιμα χαρακτηριστικά \cite{ruderOverviewMultiTaskLearning2017}. Αυτό είναι ιδιαίτερα σημαντικό στη μοντελοποίηση μονοκυτταρικών διαταραχών, όπου τα δεδομένα είναι συχνά θορυβώδη και αραιά, λόγω dropout γεγονότων και άλλων τεχνικών περιορισμών.

Όσον αφορά την επιλογή αρχιτεκτονικής στη \gls{mlt}, πρέπει να εξεταστεί ο τρόπος αλληλεπίδρασης των εργασιών, μια έννοια γνωστή ως \gls{conditioning} (conditioning) \cite{dumoulin2018feature-wise}. Στο πλαίσιο της βαθιάς μάθησης, οι δύο πιο διαδεδομένες προσεγγίσεις είναι η σκληρή (hard) και η ήπια (soft) κοινή χρήση παραμέτρων.
Στη σκληρή κοινή χρήση, το μοντέλο μοιράζεται ένα κοινό σύνολο παραμέτρων για όλες τις εργασίες, διατηρώντας όμως ξεχωριστή \gls{head} (head) για καθεμία (\cref{fig:hard}). Αυτή η προσέγγιση είναι η πιο συνηθισμένη και προτιμάται, όταν οι εργασίες είναι στενά συνδεδεμένες, καθώς επιτρέπει πιο αποδοτική μάθηση και μειώνει τον κίνδυνο υπερεκπαίδευσης.
Αντίθετα, στην ήπια κοινή χρήση παραμέτρων, κάθε εργασία διαθέτει το δικό της σύνολο παραμέτρων, αλλά αυτές προωθούνται να είναι παρόμοιες μέσω κανονικοποίησης (\cref{fig:soft}). Η προσέγγιση αυτή είναι πιο κατάλληλη για λιγότερο συσχετισμένες εργασίες, διότι προσφέρει μεγαλύτερη ευελιξία στην εκμάθηση εξειδικευμένων αναπαραστάσεων ανά εργασία, ενώ ταυτόχρονα είναι λιγότερο επιρρεπής σε αρνητική μεταφορά \cite{ruderOverviewMultiTaskLearning2017}.

\begin{figure}[h!]
    \centering
    \begin{subfigure}[t]{0.48\textwidth}
        \centering
        \includegraphics[width=.6\textwidth]{hard.png}
    \caption{Σκληρή κοινή χρήση παραμέτρων}
        \label{fig:hard}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.48\textwidth}
        \centering
        \includegraphics[width=\textwidth]{soft.png}
    \caption{Ήπια κοινή χρήση παραμέτρων}
        \label{fig:soft}
    \end{subfigure}
    \caption{\Gls{conditioning} εργασιών (Task conditioning) \cite{ruderOverviewMultiTaskLearning2017}}
    \label{}
\end{figure}

Μια άλλη προσέγγιση για υπό-συνθήκη-διαμόρφωση εργασιών είναι η οικογένεια των \glslink{film-translation}{μετασχηματισμών κατά χαρακτηριστικό} (feature-wise transformations). Στην προσέγγιση αυτή μπορούν να εφαρμοστούν τρεις διαφορετικοί τύποι μετασχηματισμού:
α) συνένωση/παράθεση (concatenation),
β) πρόσθεση (addition), και
γ) πολλαπλασιασμός (multiplication).

Οι μετασχηματισμοί αυτοί μπορούν να εφαρμοστούν ανά \gls{layer} (layer-wise), προσφέροντας μεγαλύτερη ευελιξία στον τρόπο με τον οποίο οι εργασίες ενσωματώνονται στο μοντέλο. Μπορούν να εισαχθούν είτε στην αρχική είσοδο της αρχιτεκτονικής είτε σε μεταγενέστερο στάδιο της διαδικασίας δημιουργίας.

Στην περίπτωση της συνένωσης, για μια αναπαράσταση της εργασίας $z$ (π.χ. κωδικοποιημένη σε μορφή one-hot), η είσοδος ενός \glslink{layer}{επιπέδου} συνενώνεται με το $z$, και το αποτέλεσμα υποβάλλεται σε γραμμικό μετασχηματισμό.
Αντίθετα, στις περιπτώσεις της πρόσθεσης και του πολλαπλασιασμού, η αναπαράσταση της \glslink{conditioning}{υπό-συνθήκη-διαμόρφωσης}  (conditioning representation) υφίσταται πρώτα γραμμικό μετασχηματισμό και στη συνέχεια προστίθεται ή πολλαπλασιάζεται με την είσοδο, αντίστοιχα.

Σε όλες αυτές τις μεθόδους, οι πράξεις εφαρμόζονται ανά χαρακτηριστικό (element-wise), εξ ου και η ονομασία μετασχηματισμοί κατά χαρακτηριστικό \cite{dumoulin2018feature-wise}.

\begin{figure}[h!]
    \centering
    \begin{subfigure}[t]{0.48\textwidth}
        \centering
        \includegraphics[width=\textwidth]{concat.png}
    \caption{Συνένωση/Παράθεση}
        \label{}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.48\textwidth}
        \centering
        \includegraphics[width=\textwidth]{add.png}
    \caption{Πρόσθεση}
        \label{}
    \end{subfigure}
    \begin{subfigure}[b]{.48\textwidth}
        \centering
        \includegraphics[width=\textwidth]{mul.png}
    \caption{Πολλαπλασιασμός}
        \label{}
    \end{subfigure}    
    \caption{Μετασχηματισμοί ανά χαρακτηριστικό \cite{ruderOverviewMultiTaskLearning2017}}
    \label{}
\end{figure}

Γενικότερα, οι μέθοδοι μάθησης πολλαπλών εργασιών (\gls{mlt}) μπορούν να κατηγοριοποιηθούν με βάση διάφορες διαστάσεις, όπως το πρότυπο μάθησης (π.χ. επιβλεπόμενη ή μη-επιβλεπόμενη μάθηση), τον τύπο των εργασιών (π.χ. ταξινόμηση ή παλινδρόμηση) και τον τύπο του χώρου εισόδου.  
Στην παρούσα εργασία εστιάζουμε κυρίως σε επιβλεπόμενες εργασίες, οι οποίες αποτελούν και το πλέον μελετημένο πλαίσιο στη βιβλιογραφία της \gls{mlt} \cite{zhangSurveyMultiTaskLearning2021}.  

Όπως θα παρουσιαστεί στο \crefwithname{sec:method}, η βασική εργασία που εξετάζουμε αφορά την πρόβλεψη των προφίλ γονιδιακής έκφρασης μετά από μια διαταραχή, η οποία μπορεί να διατυπωθεί ως πρόβλημα παλινδρόμησης.  
Η είσοδος αποτελείται από το βασικό προφίλ γονιδιακής έκφρασης ενός κυττάρου (ή το λεγόμενο “vehicle” προφίλ), ενώ η έξοδος αντιστοιχεί στο προφίλ έκφρασης μετά την εφαρμογή της διαταραχής.  
Η ίδια η διαταραχή αναπαρίσταται μέσω ενός \glslink{condvector}{διανύσματος της υπό-συνθήκη-διαμόρφωσης} (conditioning vector), το οποίο μπορεί απλά να υλοποιηθεί ως μια one-hot κωδικοποίηση που προσδιορίζει τον τύπο της διαταραχής που εφαρμόστηκε στο κύτταρο.  

Τυπικά, για επιβλεπόμενες εργασίες που μοιράζονται τον ίδιο χώρο εισόδου, μπορούμε να ορίσουμε ένα σύνολο από $m$ εργασίες μάθησης $\{T_{i}\}_{i=1}^m$, και για καθεμία από αυτές το αντίστοιχο σύνολο δεδομένων $\mathcal{D}_i$, το οποίο περιέχει $n_i$ δείγματα:
\[
\mathcal{D}_i = \left\{(x_j^i, y_j^i)\right\}_{j=1}^{n_i}
\]
όπου $x_j^i$ είναι το $j$-οστό δείγμα εισόδου και $y_j^i$ η αντίστοιχη ετικέτα εξόδου του.  

Η συνάρτηση κόστους (loss) για την $i$-οστή εργασία μπορεί να διατυπωθεί ως:
\[
\mathcal{L}_i(\{\theta_i, \theta_{sp}\}, \mathcal{D}_i),
\]
όπου $\theta_i$ αντιστοιχούν στις ειδικές παραμέτρους της εργασίας, ενώ $\theta_{sp}$ στις κοινές παραμέτρους μεταξύ όλων των εργασιών.  

Ο στόχος της \gls{mlt} είναι η εκμάθηση ενός συνόλου παραμέτρων $\theta$ που ελαχιστοποιεί τη συνολική απώλεια για όλες τις εργασίες, δηλαδή:
\[
\theta = \arg\min_{\theta} \sum_{i=1}^m \mathcal{L}_i(\theta_i, \mathcal{D}_i),
\]
όπου
\[
\theta = \{\theta_{sp}, \theta_1, \dots, \theta_m\}
\]
αντιπροσωπεύει το πλήρες σύνολο των παραμέτρων του μοντέλου \cite{sener2018multi}.

\subsection{Μοντελοποίηση διαταραχών (Perturbation modeling)}

Στο πεδίο της μοντελοποίησης διαταραχών μπορούν να διακριθούν τέσσερις κύριοι ερευνητικοί στόχοι \cite{gavriilidis2024mini, jiMachineLearningPerturbational2021, heumos2023best}.

\begin{enumerate}
\setlength\itemsep{0.2em}
    \item Ο πρώτος αφορά την πρόβλεψη ομικών προφίλ και φαινοτυπικών μεταβολών μετά από την εφαρμογή μιας διαταραχής.\footnote{Στην περίπτωση χημικών διαταραχών, ο όρος “διαταραχή” αναφέρεται στο συγκεκριμένο φάρμακο που εφαρμόζεται. Ωστόσο, για τους σκοπούς της εργασίας \gls{ood}, μια αλλαγή στη δοσολογία του ίδιου φαρμάκου θεωρείται επίσης διακριτή διαταραχή. Στην παρούσα μελέτη, κάθε μοναδικός συνδυασμός φαρμάκου και δοσολογίας αντιμετωπίζεται ως ξεχωριστή διαταραχή.}
Η πρόβλεψη αυτή μπορεί να εφαρμοστεί είτε σε κυτταρικές σειρές (bulk omics), είτε σε μεμονωμένα κύτταρα (single-cell omics) και αποτελεί τον πρωταρχικό στόχο, γνωστό και ως εκτός κατανομής πρόβλεψη (\gls{ood}).
Όσον αφορά τα ομικά προφίλ, το scGen αποτελεί ένα γνωστό μοντέλο αναφοράς για την πρόβλεψη μεταγραφωμικής σε διαταραγμένα μονοκύτταρα.
Στην περίπτωση των φαινοτυπικών αλλαγών, αυτές μπορεί να αφορούν, για παράδειγμα, τη βιωσιμότητα των κυττάρων ως συνάρτηση της δοσολογίας ενός φαρμάκου, η οποία συνήθως ποσοτικοποιείται μέσω των τιμών IC50.
Ένα χαρακτηριστικό παράδειγμα αποτελεί το DeepDSC \cite{li2019deepdsc}, ένα βαθύ νευρωνικό δίκτυο που προβλέπει την ευαισθησία καρκινικών κυτταρικών σειρών σε φάρμακα, με βάση τα προφίλ γονιδιακής έκφρασης και έναν περιγραφέα χημικής ένωσης (compound descriptor).
Ο περιγραφέας αυτός βασίζεται στα αποτυπώματα Morgan (Morgan fingerprints),\footnote{Τα αποτυπώματα Morgan, γνωστά και ως extended-connectivity fingerprints (ECFP), είναι ένας τύπος μοριακών αποτυπωμάτων που χρησιμοποιούνται στη χημειοπληροφορική για την αναπαράσταση της δομής μορίων σε μορφή κατάλληλη για υπολογιστική επεξεργασία. Κωδικοποιούν τα δομικά χαρακτηριστικά ενός μορίου σε ένα δυαδικό διάνυσμα \cite{morgan1965generation}.}
τα οποία αποτυπώνουν τη μονοδιάστατη και δισδιάστατη δομή της ένωσης.
    \item Ο δεύτερος στόχος αφορά την πρόβλεψη του μηχανισμού δράσης μιας διαταραχής (mode of action).
Αυτό συνεπάγεται την αναγνώριση των σηματοδοτικών οδών (signaling pathways) και των συγκεκριμένων πρωτεϊνών-στόχων (target proteins) που ενεργοποιούνται ή αναστέλλονται ως απόκριση σε μια δεδομένη διαταραχή.
Η κατανόηση των πρωτεϊνών με τις οποίες αλληλεπιδρά ένα φάρμακο, καθώς και των αλυσιδωτών μοριακών αντιδράσεων που προκαλεί, είναι θεμελιώδης για την ανακάλυψη και επανατοποθέτηση φαρμάκων (drug discovery and repurposing).
Το DeepDTAGen \cite{shah2025deepdtagen} είναι ένα \gls{mlt} μοντέλο σχεδιασμένο για να αντιμετωπίζει αυτήν την πρόκληση.
Προβλέπει την συγγένεια δέσμευσης (binding affinity) μεταξύ ενός φαρμάκου και μιας πρωτεΐνης-στόχου, ενώ παράγει και νέες υποψήφιες χημικές ενώσεις, οι οποίες αναπαρίστανται με αλφαριθμητικές συμβολοσειρές SMILES\footnote{Το ακρωνύμιο SMILES προέρχεται από το Simplified Molecular Input Line Entry System. Πρόκειται για μια αναπαράσταση μοριακών δομών βασισμένη σε κείμενο. Για παράδειγμα, η αιθανόλη, της οποίας ο μοριακός τύπος είναι CH₃CH₂OH, αναπαρίσταται στη SMILES μορφή ως “CCO”.}, προσαρμοσμένες σε έναν δεδομένο πρωτεϊνικό στόχο.
    \item Ο τρίτος στόχος είναι η πρόβλεψη αλληλεπιδράσεων διαταραχών, ένα πεδίο με ιδιαίτερη σημασία για συνδυαστικές θεραπείες.
Ο σκοπός είναι η πρόβλεψη του τρόπου με τον οποίο διαφορετικές διαταραχές αλληλεπιδρούν μεταξύ τους, που αποτελεί κρίσιμο ζήτημα για την κατανόηση των αλληλεπιδράσεων των φαρμάκων (drug-drug interactions) και πιθανών παρενεργειών.
Αυτό περιλαμβάνει, για παράδειγμα, την πρόβλεψη συνεργιστικών ή ανταγωνιστικών αποτελεσμάτων όταν δύο φάρμακα χορηγηθούν μαζί.
Το μοντέλο DeepSynergy προβλέπει έναν δείκτη συνεργίας (synergy score), έχοντας ως είσοδο τα προφίλ γονιδιακής έκφρασης μιας κυτταρικής σειράς και τους χημικούς περιγραφείς δύο φαρμάκων \cite{preuer2018deepsynergy}.
Ο δείκτης συνεργίας ποσοτικοποιεί την απόκλιση της πειραματικά παρατηρούμενης επιφάνειας απόκρισης (response surface) από εκείνη που προβλέπεται από θεωρητικά μοντέλα αναφοράς, όπως τα Loewe Additivity \cite{loewe1953problem}, Bliss Independence \cite{bliss1939toxicity}, Highest Single Agent (HSA) \cite{tan2012systematic} ή το πιο πρόσφατο Zero Interaction Potency (ZIP) \cite{yadav2015searching}.
    \item Ο τέταρτος στόχος αφορά την πρόβλεψη χημικών ιδιοτήτων.
Η εργασία μπορεί να διατυπωθεί ως σχεδίαση νέων χημικών ενώσεων (de novo compound design), ικανών να προκαλέσουν ένα επιθυμητό προφίλ γονιδιακής έκφρασης μετά από διαταραχή.
Το PerturbNet \cite{yuPerturbNetPredictsSinglecell2022} αποτελεί ένα μοντέλο που αντιμετωπίζει αυτή την πρόκληση.
Αρχικά, συμπιέζει τους χώρους χαρακτηριστικών (feature spaces) τόσο των μεταγραφωμικών προφίλ όσο και των χημικών δομών μέσω autoencoders.
Οι δύο αυτές μορφές δεδομένων συνδέονται στη συνέχεια μέσω ενός conditional invertible neural network (cINN).
Χάρη στην αναστρεψιμότητα του cINN, το μοντέλο επιτρέπει \glslink{counterfactual}{αντιγεγονικές} προβλέψεις (counterfactual predictions), διευκολύνοντας την εξερεύνηση του χημικού χώρου για ενώσεις που είναι πιθανό να προκαλέσουν μια συγκεκριμένη γονιδιακή απόκριση.
Με αυτόν τον τρόπο, η εργασία λειτουργεί ως εννοιολογική γέφυρα μεταξύ βιολογίας και χημείας, συνδέοντας τη μοριακή δομή με το φαινοτυπικό αποτέλεσμα.

\end{enumerate}


\subsection{Μάθηση πολλαπλών εργασιών και μοντελοποίηση διαταραχών}

Η μάθηση πολλαπλών εργασιών (\gls{mlt}) μπορεί να θεωρηθεί ως μια ισχυρή προσέγγιση μηχανικής μάθησης, με σημαντικές προοπτικές εφαρμογής στη μοντελοποίηση διαταραχών \cite{jiMachineLearningPerturbational2021,gavriilidis2024mini}.
Αξίζει να σημειωθεί ότι στην πρόκληση NCI-DREAM \cite{costello2014community}, η οποία αφορούσε την πρόβλεψη της ευαισθησίας φαρμάκων σε κυτταρικές σειρές, μια \gls{mlt} Bayesian προσέγγιση θεωρήθηκε ότι απέδωσε τα καλύτερα αποτελέσματα \cite{schrod2024codex}.

Πέρα από την κατηγοριοποίηση των στόχων της μοντελοποίησης διαταραχών, στόχοι της ανάλυσης μονοκυτταρικών δεδομένων, όπως η επαγωγή δικτύων γονιδιακής ρύθμισης (gene regulatory network inference, GRN), η ομαδοποίηση κυττάρων (cell clustering) και η ολοκλήρωση πολλαπλών τροπικοτήτων (multi-modal integration), μπορούν να είναι ιδιαίτερα ωφέλιμοι όταν ενσωματώνονται σε ένα \gls{mlt} υπολογιστικό πλαίσιο.
Αυτοί οι στόχοι προσδίδουν συμπληρωματικό βιολογικό περιεχόμενο, το οποίο μπορεί να ενισχύσει την απόδοση και την ερμηνευσιμότητα της μοντελοποίησης διαταραχών.

Για παράδειγμα, το UnitedNet \cite{tangExplainableMultitaskLearning2023} έχει επιδείξει υψηλή απόδοση στη διατροπική πρόβλεψη (cross-modal prediction) και στην ταξινόμηση κυτταρικών τύπων, αξιοποιώντας πολυ-ομικά δεδομένα μέσω μιας \gls{mlt} αρχιτεκτονικής.
Αντίστοιχα, το scPreGAN \cite{weiScPreGANDeepGenerative2022} ενσωματώνει την ταξινόμηση κυτταρικών τύπων ως βοηθητική εργασία (auxiliary task) για τη βελτίωση της πρόβλεψης μονοκυτταρικών προφίλ μεταγραφωμικής μετά από διαταραχή, υπογραμμίζοντας την αξία του συνδυασμού μονοκυτταρικών εργασιών με τους στόχους μοντελοποίησης διαταραχών.

Η ταυτόχρονη επίλυση πολλαπλών εργασιών μπορεί να είναι απαιτητική, όταν αυτές λειτουργούν σε διαφορετικά επίπεδα λεπτομέρειας (granularity).
Για παράδειγμα, η πρόβλεψη βιωσιμότητας κυττάρων ή ευαισθησίας σε φάρμακα βάσει τιμών IC50 θεωρείται εργασία σε επίπεδο πληθυσμού, ενώ η πρόβλεψη γονιδιακής έκφρασης μονοκυττάρων μετά από διαταραχή αφορά το κυτταρικό επίπεδο.
Για την πρώτη περίπτωση, υπάρχουν διαθέσιμα σύνολα δεδομένων που περιλαμβάνουν πληροφορίες για τα προφίλ γονιδιακής έκφρασης κυτταρικών σειρών, μαζί με τα χημικά χαρακτηριστικά και τις αντίστοιχες τιμές IC50.
Αντίθετα, στην πρόβλεψη μονοκυτταρικών αποκρίσεων σε διαταραχές, ένα αντίστοιχο φαινοτυπικό χαρακτηριστικό σε επίπεδο πληθυσμού (όπως τιμές IC50), τις περισσότερες φορές δεν είναι άμεσα διαθέσιμο από το ίδιο πείραμα.
Η ταυτόχρονη επίλυση αυτών των εργασιών θα απαιτούσε σύνδεση δεδομένων από κυτταρικές σειρές (bulk omics) και μονοκυτταρικών δεδομένων (single-cell omics), λαμβάνοντας υπόψη τις τεχνικές διαφοροποιήσεις μεταξύ των πειραματικών διαδικασιών συλλογής δεδομένων.

Από την άλλη πλευρά, η εργασία της πρόβλεψης αποκρίσεων διαταραχών σε επίπεδο πληθυσμού θα μπορούσε να ενσωματωθεί με άλλες εργασίες πληθυσμιακού επιπέδου, όπως η βιωσιμότητα κυττάρων, η ευαισθησία σε φάρμακα, η πρόβλεψη συνεργιών και η πρόβλεψη πρωτεΐνικών στόχων ή σηματοδοτικών οδών.
Βάσεις δεδομένων που μπορούν να προσφέρουν τις απαραίτητες πληροφορίες για αυτήν την ανάλυση, διασταυρώνοντας διαφορετικές κυτταρικές σειρές, περιλαμβάνουν:
\begin{itemize}
    \setlength\itemsep{0em}
    \item LINCS L1000 \cite{subramanian2017next}, το οποίο περιέχει 689.831 μετρήσεις microarray από 170 διαφορετικές κυτταρικές σειρές που έχουν υποβληθεί σε αγωγή με 20.065 ενώσεις.
    \item Genomics of Drug Sensitivity in Cancer (GDSC) \cite{iorio2016landscape}, η οποία καταγράφει τα γονιδιωματικά προφίλ 639 ανθρώπινων καρκινικών κυτταρικών σειρών και τα δεδομένα απόκρισης τους σε 130 φάρμακα.
    \item Το μεγάλης κλίμακας ογκολογικό πείραμα Merck \& Co. \cite{o2016unbiased}, το οποίο περιλαμβάνει 23.062 δείγματα, όπου κάθε δείγμα αποτελείται από δύο χημικές ενώσεις και μία κυτταρική σειρά.
\end{itemize}

Αντί να αντιμετωπίζονται οι στόχοι της μοντελοποίησης διαταραχών ως ανεξάρτητες εργασίες, οι ίδιοι οι στόχοι μπορούν να διατυπωθούν μέσω ενός \gls{mlt} υπολογιστικού πλαισίου.
Για παράδειγμα, ορίζοντας την πρόβλεψη της γονιδιακής έκφρασης για μια συγκεκριμένη διαταραχή ως μία εργασία, η \gls{mlt} χρησιμοποιείται έμμεσα από μοντέλα όπως τα scVIDR \cite{kanaGenerativeModelingSinglecell2023} και CODEX \cite{schrod2024codex}.
Τα μοντέλα αυτά εκτελούν την ίδια εργασία για πολλαπλές διαταραχές, χρησιμοποιώντας ένα ενιαίο μοντέλο και κωδικοποιώντας τη διαταραχή ως \gls{condsignal} (conditioning signal).

Ένα ακόμη παράδειγμα υποδιαίρεσης ενός συγκεκριμένου στόχου διαταραχής αποτελεί το STAMP \cite{gaoSubtaskDecompositionbasedLearning2024}, ένα \gls{mlt} μοντέλο που προβλέπει το διαφορικό αποτέλεσμα μιας διαταραχής σε σχέση με το προφίλ γονιδιακής έκφρασης ελέγχου.
Για τον σκοπό αυτόν, το μοντέλο ορίζει τρεις επιμέρους εργασίες:
α) ποια γονίδια είναι διαφοροποιημένα,
β) το μέγεθος της διαφοροποίησης της έκφρασης, και
γ) την κατεύθυνση αυτής της διαφοροποίησης.
Το μοντέλο εκπαιδεύεται ώστε να προβλέπει αυτές τις τρεις εργασίες ταυτόχρονα, επιτρέποντας μια πιο ολοκληρωμένη κατανόηση της επίδρασης της διαταραχής.

\clearpage

\subsection{Βιβλιογραφία για την πρόβλεψη εκτός κατανομής (OOD) σε μονοκυτταρικά δεδομένα}
\label{sec:benchmark_models}

Βάσει της προηγούμενης ανάλυσης σχετικά με την αξιοποίηση της σύνδεσης των στόχων της μοντελοποίησης διαταραχών, δόθηκε έμφαση στη μονοκυτταρική περίπτωση, καθώς αυτή έχει διερευνηθεί εκτενώς στη βιβλιογραφία λόγω των πρόσφατων εξελίξεων της μονοκυτταρικής τεχνολογίας.
Για σύγκριση και αξιολόγηση σχετικά με τη προτεινόμενη μεθοδολογία αυτής της έρευνας, επιλέξαμε τις παρακάτω αντιπροσωπευτικές μονοκυτταρικές μεθόδους: α) scGen \cite{lotfollahiScGenPredictsSinglecell2019}, β) scVIDR \cite{kanaGenerativeModelingSinglecell2023}, γ) scPreGAN \cite{weiScPreGANDeepGenerative2022} και δ) scButterfly \cite{caoScButterflyVersatileSinglecell2024}.

\subsubsection{scGen}

Η αρχιτεκτονική του scGen βασίζεται σε ένα \gls{vae} που μαθαίνει μια πιθανοτική \glslink{latent}{λανθάνουσα} αναπαράσταση των προφίλ γονιδιακής έκφρασης. Η επίδραση της διαταραχής μοντελοποιείται ως διάνυσμα $\delta$, το οποίο υπολογίζεται ως η μέση τιμή των διαφορών μεταξύ των λανθανόντων διανυσμάτων των προφίλ ελέγχου και διαταραχής. Στη συνέχεια, για ένα μη-παρατηρημένο τύπο κυττάρου, το λανθάνον διάνυσμα του διαταραγμένου προφίλ $\hat{z}$ προκύπτει προσθέτοντας το διάνυσμα διαταραχής $\delta$ στο λανθάνον διάνυσμα του ελέγχου $z$ με τη σχέση $\hat{z} = z + \delta$. Τέλος, το διαταραγμένο προφίλ γονιδιακής έκφρασης λαμβάνεται αποκωδικοποιώντας το $\hat{z}$ μέσω του αποκωδικοποιητή του \gls{vae}. Αυτή η μέθοδος επιτρέπει τη δημιουργία νέων διαταραγμένων προφίλ μέσω πράξεων στον λανθάνοντα χώρο.

\subsubsection{scVIDR}

Μια σημαντική περιοριστική παράμετρος του scGen είναι η έλλειψη ρητής μοντελοποίησης ανά τύπο κυττάρου, κάτι που μπορεί να περιορίσει τη γενίκευση σε κυτταρικούς τύπους με διακριτές αποκρίσεις σε διαταραχές. Το scVIDR αντιμετωπίζει αυτό το ζήτημα με την ενσωμάτωση εκτίμησης διαταραχής προσαρμοσμένης στον τύπο κυττάρου (cell-type-aware). Αντί για ένα ενιαίο καθολικό διάνυσμα διαταραχής $\delta$ που υπολογίζεται μόνο από τις ετικέτες συνθήκης, το scVIDR προσαρμόζει ένα γραμμικό μοντέλο που αποτυπώνει τον τρόπο με τον οποίο τα διανύσματα διαταραχής ποικίλουν ανά τύπο κυττάρου.

Για κάθε εκπαιδευτικό τύπο κυττάρου $i$, ορίζεται το διάνυσμα διαταραχής $\delta_i = \hat{z}_i - z_i$, όπου $z_i$ και $\hat{z}_i$ είναι οι μέσες λανθάνουσες αναπαραστάσεις των κυττάρων ελέγχου και διαταραχής αντίστοιχα. Έπειτα εκπαιδεύεται ένα γραμμικό μοντέλο ώστε να προβλέπει $\hat{\delta}_i$ από το $z_i$, δηλαδή $\hat{\delta}_i = f(z_i)$.

Μόλις εκπαιδευτεί, το μοντέλο αυτό μπορεί να προβλέψει το διάνυσμα διαταραχής $\delta_A$ για έναν μη-παρατηρημένο τύπο κυττάρου $A$, χρησιμοποιώντας μόνο τη λανθάνουσα αναπαράσταση της κατάστασης ελέγχου $z_A$, δηλαδή $\hat{\delta}_A = f(z_A)$. Αυτή η προσέγγιση ανά τύπο κυττάρου βελτιώνει τη γενίκευση επιτρέποντας στο μοντέλο να προσαρμόζει την απόκριση διαταραχής σύμφωνα με την κατάσταση ελέγχου κάθε κυτταρικού τύπου.

Το scVIDR μπορεί επίσης να προβλέψει προφίλ έκφρασης για πολλαπλές δοσολογίες. Σε αυτή την περίπτωση, το γραμμικό μοντέλο προσαρμόζεται μεταξύ των δοσολογιών χαμηλού και υψηλού επιπέδου και οι ενδιάμεσες δοσολογίες προκύπτουν με λογαριθμική γραμμική παρεμβολή στο $\hat{\delta}_c$.

Όσον αφορά την ερμηνευσιμότητα, ο περιορισμός της μη-γραμμικής αντιστοίχισης από τον λανθάνοντα χώρο στο χώρο γονιδιακής έκφρασης αντικαθίσταται από μια γραμμική συσχέτιση, χρησιμοποιώντας ένα sparse linear regression model. Αυτό προσεγγίζεται από έναν πίνακα βαρών $\hat{W}_{VAE}$ διαστάσεων $M \times G$, όπου $M$ ο αριθμός των λανθανουσών μεταβλητών και $G$ ο αριθμός των γονιδίων. Ο πίνακας αυτός χρησιμοποιείται για να εκτιμηθεί η συνεισφορά των λανθανουσών μεταβλητών στο προφίλ γονιδιακής έκφρασης μέσω της σχέσης:

\[\text{gene score} = \hat{\delta}_c^T \hat{W}_{VAE}\]

Μια μεγαλύτερη τιμή gene score υποδηλώνει μεγαλύτερη μεταβολή στην έκφραση του γονιδίου όταν αυξάνει η δοσολογία.

\subsubsection{scPreGAN}

Το scPreGAN ενσωματώνει έναν autoencoder με \gls{gan} για την πρόβλεψη μονοκυτταρικών δεδομένων υπό διαταραχή. Η αρχιτεκτονική αποτελείται από έναν κοινό κωδικοποιητή και δύο \glslink{generator}{δημιουργητές} (generators), ένα για κάθε συνθήκη (ελέγχου και διαταραχής). Για την ευθυγράμμιση των παραγόμενων κατανομών με τα πραγματικά δεδομένα, το μοντέλο χρησιμοποιεί δύο \glslink{discriminator}{διακριτές} (discriminators), καθένας συνδεδεμένος με την αντίστοιχη συνθήκη.

Ο κοινός κωδικοποιητής μαθαίνει μια λανθάνουσα αναπαράσταση ανεπηρέαστη από τη διαταραχή, που αποτυπώνει βιολογικά χαρακτηριστικά υψηλού επιπέδου κοινά και στις δύο καταστάσεις. Οι δημιουργητές ενσωματώνουν στη συνέχεια τα χαρακτηριστικά επίδρασης της διαταραχής για την ανακατασκευή των προφίλ γονιδιακής έκφρασης από τον λανθάνοντα χώρο. Οι διακριτές εκπαιδεύονται να διακρίνουν τα πραγματικά από τα δείγματα του δημιουργού, ενώ οι δημιουργητές βελτιστοποιούνται αντιπαραθετικά, ώστε να παράγουν ρεαλιστικές ανακατασκευές που παραπλανούν τους διακριτές.


\subsubsection{scButterfly}
\label{sec:scbutterfly}

Το scButterfly είναι ένα generative adversarial μοντέλο που βασίζεται σε μια dual-aligned \gls{vae} αρχιτεκτονική, σχεδιασμένο για διατροπική μετάφραση (cross-modal translation) σε μονοκυτταρικά δεδομένα. Το μοντέλο έχει επιδείξει καλές επιδόσεις στην μετάφραση μεταξύ μεταγραφωμικών προφίλ και προφίλ προσβασιμότητας χρωματίνης, καθώς και μεταξύ μεταγραφωμικών και πρωτεωμικών δεδομένων.

Η αρχιτεκτονική του αποτελείται από δύο \gls{vae}s, το καθένα προεκπαιδευμένο σε μία συγκεκριμένη \gls{modality} (πχ, μεταγραφωμική, πρωτεωμική), και έναν \glslink{translator}{μεταφραστή} (translator) που ευθυγραμμίζει τους λανθάνοντες χώρους των δύο κωδικοποιητών. Ο μεταφραστής αποτελείται από δύο νευρωνικά δίκτυα, ένα ανά τροπικότητα, και το καθένα μοντελοποιεί μια Gaussian κατανομή στον λανθάνοντα χώρο. Αυτά τα δίκτυα λαμβάνουν ως είσοδο τη λανθάνουσα αναπαράσταση του κωδικοποιητή, δείγμα από την εκτιμημένη κατανομή, και προωθούν το δείγμα στον αποκωδικοποιητή της άλλης τροπικότητας, επιτρέποντας \glslink{crossmodality}{διατροπική} (cross-modal) παραγωγή.

Μετά την προεκπαίδευση των VAE, ο μεταφραστής εκπαιδεύεται, ώστε να ευθυγραμμίσει τους λανθάνοντες χώρους, για να επιτευχθεί βιολογικά ουσιώδης μετάφραση μεταξύ των τροπικοτήτων.

Αν και το scButterfly δεν έχει σχεδιαστεί πρωτίστως για \gls{perrbmodel}, η μελέτη έδειξε την προοπτική του, όταν τα προφίλ ελέγχου και διαταραχής αντιμετωπίζονται ως δύο διαφορετικές τροπικότητες. Ένας περιορισμός του είναι η μεθοδολογία αξιολόγησης του, διότι έχει δοκιμαστεί σε ένα μόνο σενάριο και συγκεκριμένα σε ανθρώπινα μονοπύρηνα κυττάρα περιφερικού αίματος (\gls{pbmc}), εφαρμόζοντας διαταραχή, τύπου ιντερφερόνης βήτα (\gls{ifnb}) \cite{kanaGenerativeModelingSinglecell2023}.


\clearpage

\section{Περιγραφή του αλγορίθμου}
\label{sec:method}

Για να διευκολυνθεί μια προσέγγιση μάθησης πολλαπλών εργασιών, ορίζουμε ως εργασία την πρόβλεψη του διαταραγμένου μονοκυτταρικού προφίλ γονιδιακής έκφρασης σε ένα αποκλεισμένο πλαίσιο (held-out context), με είσοδο το προφίλ ελέγχου και τον τύπο της διαταραχής. Το μοντέλο μαθαίνει τις επιδράσεις των διαταραχών από τα υπόλοιπα πλαίσια και γενικεύει αυτή τη γνώση σε άγνωστα σενάρια.

Αυτή η ρύθμιση επιτρέπει την αξιολόγηση της ικανότητας του μοντέλου να εξάγει (extrapolate) γνωστές επιδράσεις διαταραχών σε νέους βιολογικούς ή πειραματικούς τομείς και αντιπροσωπεύει τον κύριο στόχο της μοντελοποίησης διαταραχών, δηλαδή την πρόβλεψη εκτός κατανομής (\gls{ood}). Ένα τυπικό σύνολο δεδομένων για αυτό το έργο αποτελείται από μονοκυτταρικά μεταγραφωμικά προφίλ (\gls{sc}) από πολλαπλά βιολογικά πλαίσια, όπως διαφορετικοί τύποι κυττάρων, είδη διαταραχών, δοσολογίες, μελέτες ή είδη οργανισμών, υπό συνθήκες ελέγχου και διαταραχής.

Παρόμοια με τη μελέτη φαρμάκου-πρωτεΐνης (drug–protein) \cite{allenspach2024neural}, όπου η πρόβλεψη της δέσμευσης συγγένειας (binding affinity) μεταξύ ενός φαρμάκου και μιας πρωτεΐνης αντιστοιχεί σε ξεχωριστή εργασία για κάθε πρωτεΐνη, εδώ αντιμετωπίζουμε κάθε διαταραχή ως διακριτή εργασία.

% why the perturbation has been integrated not at the input but the decoder? 

% some models are able to predict for unseen perturbation, not only unseen cell, this should mention, and why we followed this approach, the mlt for drug design is the case that the model can for unseen cell and unseen perturbation.

Στην προσέγγισή μας στοχεύουμε να αποσυνδέσουμε την επίδραση της διαταραχής (perturbation effect) μέσω της κατασκευής ενός λανθάνοντος χώρου απαλλαγμένου από τη διαταραχή (perturbation-free latent space), ενώ ταυτόχρονα μοντελοποιούμε ρητά την απόκριση στη διαταραχή μέσω ενός \glslink{condsignal}{σήματος υπό-συνθήκη-διαμόρφωσης}, το οποίο αντιπροσωπεύει τον τύπο της διαταραχής.

Η διαταραχή αναπαρίσταται ως διάνυσμα one-hot κωδικοποίησης, όπου, για ένα σύνολο δεδομένων με $N$ διαταραχές, το \gls{condvector}  έχει μήκος $N + 1$, με μια επιπλέον θέση που αντιπροσωπεύει τη συνθήκη ελέγχου (control condition).


\begin{wrapfigure}{r}{0.4\textwidth}
  \begin{center}
    \includegraphics[width=.4\textwidth]{film_layers.png}
  \end{center}
  \caption{FiLM \cite{dumoulin2018feature-wise}}
\end{wrapfigure}

Όσον αφορά την υπό-συνθήκη-διαμόρφωση των εργασιών, όπως αναφέρθηκε στο \crefwithname{sec:mlt}, εξετάσαμε την εφαρμογή \glslink{caf}{υπό-συνθήκη αφινικών μετασχηματισμών} (conditional affine transformations), έναν συνδυασμό πολλαπλασιαστικού και προσθετικού μετασχηματισμού που μετατοπίζει και κλιμακώνει την είσοδο στοιχείο προς στοιχείο. Αυτή η μέθοδος είναι αποδοτική ως προς την κλιμάκωση και τον αριθμό παραμέτρων σε σχέση με αρχιτεκτονικές πολλαπλών \glslink{head}{κεφαλών} (multi-head), όπου κάθε εργασία έχει το δικό της δίκτυο για την παραγωγή εξόδου. Η προσέγγιση αυτή ονομάζεται \gls{film} (Feature-wise Linear Modulation) \cite{dumoulin2018feature-wise, perez2018film}:

\[ \text{FiLM}(x) = \gamma(z) \odot x + \beta(z) \]

όπου τα $\gamma$ και $\beta$ είναι παράμετροι διαμόρφωσης (modulation parameters) που παράγονται από τον \glslink{filmgen}{FiLM δημιουργό}, ο οποίος δέχεται ως είσοδο μία συνθήκη $z$, και $x$ είναι η είσοδος προς μετασχηματισμό. Ένα \glslink{filmlayers}{FiLM επίπεδο} εφαρμόζει τον παραπάνω μετασχηματισμό στην είσοδο ενός επιπέδου, με τις παραμέτρους $\gamma$ και $\beta$ να μπορούν να παραχθούν είτε από κοινό δημιουργό είτε από δημιουργό ξεχωριστό για κάθε επίπεδο. Το αποτέλεσμα προωθείται στα υπόλοιπα μέρη του δικτύου.


% \begin{figure}[h!]
%     \centering
%     \begin{subfigure}[t]{0.48\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{film_layers.png}
%         \caption{Illustration of the FiLM layer}
%         \label{}
%     \end{subfigure}
%     \hfill
%     \begin{subfigure}[t]{0.48\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{film_gen.png}
%         \caption{A common FiLM generator used across FiLM layers}
%         \label{}
%     \end{subfigure}
%     \caption{Illustration of the FiLM \cite{dumoulin2018feature-wise}}
%     \label{fig:film}
% \end{figure}

% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=0.5\textwidth]{film_layers.png}
%     \caption{Illustration of the feature-wise transformation \cite{dumoulin2018feature-wise}}
%     \label{fig:film}
% \end{figure}

\begin{figure}[h!]
    \includegraphics[width=\textwidth]{biorender_film_architecture_4.png}
    \caption[Απεικόνιση της αρχιτεκτονικής \gls{mlt}]{Απεικόνιση της αρχιτεκτονικής \gls{mlt} (δημιουργήθηκε στο \url{https://BioRender.com}). Ο κωδικοποιητής μοιράζεται μεταξύ όλων των εργασιών, ενώ ο αποκωδικοποιητής προσαρμόζεται από \gls{filmlayers} ειδικά για κάθε εργασία. Στο παράδειγμα αυτό ενσωματώνονται δύο FiLM επίπεδα στα δύο πρώτα κρυφά στρώματα του αποκωδικοποιητή. Ο \gls{filmgen} λαμβάνει ως είσοδο ένα διάνυσμα της υπό-συνθήκη-διαμόρφωσης των διαταραχών (π.χ. one-hot κωδικοποίηση) και παράγει τις παραμέτρους διαμόρφωσης $\gamma$ και $\beta$ για τα FiLM επίπεδα.}
\end{figure}


Η βασική αρχιτεκτονική μας βασίζεται σε έναν autoencoder, ενώ το σήμα υπό-συνθήκη-διαμόρφωσης ενσωματώνεται μέσω FiLM επιπέδων στον αποκωδικοποιητή (αναφερόμενο ως \verb|MTAe|). Οι παράμετροι διαμόρφωσης $\gamma$ και $\beta$ μαθαίνονται ανεξάρτητα για κάθε σημείο συγχώνευσης με έναν ξεχωριστό FiLM δημιουργό.

Κατά την εκπαίδευση, το μοντέλο μαθαίνει να ανακατασκευάζει τα διαταραγμένα προφίλ γονιδιακής έκφρασης από τα προφίλ ελέγχου, ενώ τα FiLM επιπέδα  τροποποιούν τα κρυφά επίπεδα του αποκωδικοποιητή με βάση τον τύπο της διαταραχής.

Η απώλεια που χρησιμοποιείται είναι η απώλεια ανακατασκευής (reconstruction loss) του autoencoder, δηλαδή το μέσο τετραγωνικό σφάλμα μεταξύ της εισόδου και της εξόδου του αποκωδικοποιητή:
\[
\mathcal{L}_{\text{recon}} = \frac{1}{N} \sum_{i=1}^{N} ||x_i - \hat{x}_i||^2 \]
όπου $x_i$ και $\hat{x}_i$ είναι αντίστοιχα το αρχικό και το ανακατασκευασμένο προφίλ γονιδιακής έκφρασης, και $N$ ο αριθμός των δειγμάτων.

% I could mention why the condition isn't integrated at the first layers?


Έχουμε διερευνήσει αρκετές παραλλαγές αυτής της προσέγγισης, οι οποίες διατηρούν την αρχιτεκτονική του αποκωδικοποιητή και ενσωματώνουν \gls{filmlayers} σε όλα τα κρυφά επίπεδα του αποκωδικοποιητή. Οι παραλλαγές αυτές μπορούν να χωριστούν σε τρεις κύριες ομάδες: α) adversarial autoencoders, β) optimal transport και γ) Variational Autoencoders (VAEs).


% I have to document the losses

\begin{figure}[h!]
    \centering
    \includegraphics[width=.9\textwidth]{basic_flowchart.png}
    \caption{Διάγραμμα ροής για μία επανάληψη εκπαίδευσης της αρχιτεκτονικής MTAe}
\end{figure}

\clearpage

\subsection{Adversarial autoencoders (AeAdv)}

Στις παραλλαγές με adversarial autoencoders εισάγουμε δομή στον λανθάνοντα χώρο μέσω μιας \glslink{adversarialloss}{αντιπαραθετικής απώλειας} (adversarial loss). Η αρχιτεκτονική της προσέγγισης αυτής επεκτείνει τον προαναφερθέντα autoencoder με \gls{filmlayers}, προσθέτοντας έναν \glslink{discriminator}{διακριτή} (discriminator). Ο διακριτής εκπαιδεύεται να διακρίνει μεταξύ των κωδικοποιημένων λανθανόντων διανυσμάτων και των δειγμάτων από μια στοχευμένη κατανομή, ενώ ο κωδικοποιητής εκπαιδεύεται αντιπαραθετικά ώστε να τον "ξεγελάει". Αυτό ενθαρρύνει τον λανθάνοντα χώρο να προσεγγίζει την επιθυμητή στοχευμένη κατανομή \cite{makhzani2015adversarial}.

Στην αρχιτεκτονική \verb|MTAeAdv| στοχεύουμε στη ρητή διαμόρφωση ενός λανθάνοντα χώρου ανεπηρέαστου από τη διαταραχή (perturbation-free). Σε αυτήν την περίπτωση, ο διακριτής εκπαιδεύεται να διακρίνει μεταξύ λανθανουσών αναπαραστάσεων προφίλ ελέγχου και διαταραχής, ενώ ο κωδικοποιητής προσπαθεί να τις καταστήσει αδιάκριτες. Η κατανομή που στοχεύουμε να επιβάλλουμε είναι αυτή των λανθανουσών αναπαραστάσεων των προφίλ ελέγχου.

Αντίθετα, στην αρχιτεκτονική \verb|MTAeAdvG| επιβάλλουμε μια Gaussian κατανομή στον λανθάνοντα χώρο. Ο διακριτής μαθαίνει να ξεχωρίζει μεταξύ των λανθανόντων διανυσμάτων του κωδικοποιητή και των δειγμάτων από μια πολύδιανυσματική Gaussian κατανομή, ενώ ο κωδικοποιητής μαθαίνει να προσαρμόζει την έξοδό του, ώστε να ακολουθεί αυτήν την κατανομή.

Η συνολική απώλεια για τον adversarial autoencoder είναι ένας συνδυασμός της απώλειας ανακατασκευής και της αντιπαραθετικής απώλειας, οριζόμενης ως:
\[\mathcal{L}_{\text{Adv}} = (1 - \lambda) \mathcal{L}_{\text{recon}} +  \lambda \mathcal{L}_{\text{adv}}\]
όπου $\lambda$ είναι ένας υπερπαράγοντας που ελέγχει την ισορροπία μεταξύ ανακατασκευής και αντιπαραθετικής απώλειας, και $\mathcal{L}_{\text{adv}}$ μπορεί να οριστεί ως η δυαδική διασταυρούμενη εντροπία (binary cross-entropy) μεταξύ των προβλέψεων του διακριτή και των αληθινών ετικετών (1 για πραγματικά δείγματα, 0 για παραγόμενα):
\[\mathcal{L}_{\text{adv}} = -\frac{1}{N} \sum_{i=1}^{N} \left[ y_i \log(D(z_i)) + (1 - y_i) \log(1 - D(z_i)) \right]\]
όπου $D(z_i)$ είναι η πρόβλεψη του διακριτή για το $i$-οστό λανθάνον διάνυσμα $z_i$, και $y_i$ η αληθινή ετικέτα \cite{nielsen2015neural}.

% \begin{figure}
%     \centering
%     \begin{subfigure}[t]{0.48\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{ae_gauss_sketch.png}
%         \caption{}
%         \label{}
%     \end{subfigure}
%     \hfill
%     \begin{subfigure}[t]{0.48\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{ae_adv_sketch.png}
%         \caption{}
%         \label{}
%     \end{subfigure}
%     \caption{Adversarial autoencoders}
%     \label{}
% \end{figure}


\begin{figure}[h!]
    \includegraphics[width=\textwidth]{mtadv.png}
    \caption{Απεικόνιση της αρχιτεκτονικής MTAeAdv}
\end{figure}

\begin{figure}[h!]
    \includegraphics[width=\textwidth]{mtadvg.png}
    \caption{Απεικόνιση της αρχιτεκτονικής MTAeAdvG}
\end{figure}


\begin{figure}[h!]
    \includegraphics[width=\textwidth]{gaussian_flowchart.png}
    \caption{Διάγραμμα ροής για μία επανάληψη εκπαίδευσης της αρχιτεκτονικής MTAeAdvG και MTAeAdv}
\end{figure}

\clearpage

\subsection{Optimal transport}

Μια άλλη ομάδα παραλλαγών ενσωματώνει την ιδέα του optimal transport (\gls{ot}) για να αντιμετωπίσει την έλλειψη ζευγαρωμένων δειγμάτων σε μονοκυτταρικά δεδομένα. Δεδομένης της αδυναμίας προσδιορισμού του ίδιου κυττάρου τόσο πριν όσο και μετά από μια διαταραχή εξαιτίας της καταστροφής του κατά τη διάρκεια της μέτρησης, δεν υπάρχουν αληθινές αντιστοιχίσεις ένα προς ένα μεταξύ των συνθηκών ελέγχου και διαταραχής. Συνεπώς, η μοντελοποίηση πρέπει να βασιστεί στη σύγκριση κατανομών παρά σε μεμονωμένες αλλαγές σε επίπεδο κυττάρου \cite{caoScButterflyVersatileSinglecell2024}.

Για την αντιμετώπιση αυτού του προβλήματος χρησιμοποιούμε ΟΤ για να προσεγγίσουμε αντιστοιχίσεις μεταξύ κατανομών, εμπνευσμένοι από την προσέγγιση της αρχιτεκτονικής του scButterfly (\cref{sec:scbutterfly}). Συγκεκριμένα, για ένα τυχαίο δείγμα από την κατανομή ελέγχου, ανατίθεται ένα αντίστοιχο δείγμα από την κατανομή διαταραχής βάσει του OT. Αυτή η ψευδο-αντιστοίχιση επιτρέπει την επαναδιατύπωση του στόχου εκπαίδευσης: αντί να ανακατασκευάζεται η είσοδος (όπως σε έναν τυπικό autoencoder), το μοντέλο εκπαιδεύεται να αντιστοιχεί κύτταρα ελέγχου στα κύτταρα της διαταραγμένης κατανομής.

Η απώλεια ορίζεται ως το μέσο τετραγωνικό σφάλμα μεταξύ εισόδου και εξόδου του αποκωδικοποιητή:

\[
\mathcal{L}_{\text{OT}} = \frac{1}{N} \sum_{i=1}^{N} ||x_i - \hat{x}_i||^2 
\]

όπου $x_i$ είναι το προφίλ γονιδιακής έκφρασης εισόδου, $\hat{x}_i$ το αντιστοιχισμένο (paired) διαταραγμένο προφίλ και $N$ ο αριθμός των δειγμάτων.

Σε σχέση με τις προηγούμενες αρχιτεκτονικές, τα διαταραγμένα προφίλ γονιδιακής έκφρασης δεν χρησιμοποιούνται ως είσοδοι προς ανακατασκευή αλλά ως μία κατανομή που στοχεύουμε να προσεγγίσουμε,  έχοντας ως είσοδο το προφίλ ελέγχου και τον τύπο διαταραχής. Αυτή η προσέγγιση ονομάζεται \verb|MTAeOT|. Επιπλέον, έχουμε δοκιμάσει την προεκπαίδευση του μοντέλου με την αρχιτεκτονική \verb|MTAe| και κατόπιν fine-tune με την \verb|MTAeOT|, μια στρατηγική που ονομάσαμε \verb|MTAePlusOT| (\cref{fig:mtotfinetune}).

% \begin{figure}
%     \centering
%     \includegraphics[width=\textwidth]{ae_ot_sketch.png}
%     \caption{Using optimal transport to fine-tune the MTAe architecture (MTAePlusOT)}
% \end{figure}

\clearpage

\begin{figure}[h!]
    \includegraphics[width=\textwidth]{mtopt.png}
    \caption{Απεικόνιση της αρχιτεκτονικής MTAeOT}
\end{figure}

\begin{figure}[h!]
    \includegraphics[width=\textwidth]{ot_flowchart.png}
    \caption{Διάγραμμα ροής για μία επανάληψη εκπαίδευσης της αρχιτεκτονικής MTAeΟΤ}
\end{figure}

\clearpage


\subsection{Variational Autoencoder (VAE)}

Η τελευταία ομάδα παραλλαγών περιλαμβάνει τον \gls{vae}. Η αρχιτεκτονική της παραλλαγής αυτής βασίζεται στο προαναφερθέν υπολογιστικό πλαίσιο του autoencoder με FiLM επίπεδα και επιπλέον ενσωματώνει μια VAE-απώλεια για να κανονικοποιήσει τον λανθάνοντα χώρο. Η VAE-απώλεια ορίζεται ως το άθροισμα της απώλειας ανακατασκευής και της απόκλισης Kullback--Leibler (KL) μεταξύ της εκμαθημένης λανθάνουσας κατανομής και μιας κανονικής κατανομής \cite{kingma2019introduction}:

\[
\mathcal{L}_{\text{VAE}} = - \mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)] + D_{\text{KL}}(q_\phi(z|x) \,\|\, p(z))
\]

Εδώ, $q_\phi(z|x)$ είναι η προσεγγιστική posterior κατανομή των λανθανουσών μεταβλητών που παράγει ο κωδικοποιητής, $p_\theta(x|z)$ η πιθανότητα του αποκωδικοποιητή για την ανακατασκευή της εισόδου, και $p(z) \sim \mathcal{N}(0, I)$. Το μοντέλο αυτό ονομάζεται \verb|MTVae|, και όπως αναφέρθηκε στην περίπτωση του optimal transport, υπάρχουν επίσης οι αντίστοιχες παραλλαγές \verb|MTVaeOT| και \verb|MTVaePlusOT|.

% \begin{figure}
%     \centering
%     \includegraphics[width=0.8\textwidth]{vae_sketch.png}
%     \caption{VAE}
% \end{figure}

\vspace{60pt}

\begin{figure}[h!]
    \includegraphics[width=\textwidth]{mtoptfinetune.png}
    \caption{Απεικόνιση των αρχιτεκτονικών MTAePlusOT και MTVaePlusOT}
    \label{fig:mtotfinetune}
\end{figure}

\begin{figure}[h!]
    \includegraphics[width=\textwidth]{mtvae.png}
    \caption{Απεικόνιση της αρχιτεκτονικής MTVae}
\end{figure}


\begin{figure}[h!]
    \includegraphics[width=\textwidth]{vae_flowchart.png}
    \caption{Διάγραμμα ροής για μία επανάληψη εκπαίδευσης της αρχιτεκτονικής MTVae}
\end{figure}

\clearpage

\section{Αξιολόγηση αποτελεσμάτων}

% Αναφορά για preprocessing

Τα μοντέλα που περιγράφονται στο \crefwithname{sec:benchmark_models} λειτουργούν ως σημεία αναφοράς (baseline) για την αξιολόγηση των αρχιτεκτονικών μάθησης πολλαπλών εργασιών στην εργασία πρόβλεψης εκτός κατανομής (\gls{ood}). Σε αντίθεση με τη δική μας πρόταση, αυτά τα μοντέλα αναφοράς (baseline) έχουν συνήθως σχεδιαστεί για να προβλέπουν τη διαταραγμένη γονιδιακή έκφραση για έναν μόνο, σταθερό τύπο διαταραχής και στερούνται της δυνατότητας να πραγματοποιήσουν \gls{conditioning} σε μεταβαλλόμενους τύπους διαταραχών. Εξαίρεση αποτελεί το scVIDR, το οποίο μπορεί να λάβει υπόψη διαφορετικές δοσολογίες ενός φαρμάκου, επιτρέποντας σε ένα μόνο μοντέλο scVIDR να προβλέψει αποκρίσεις για πολλαπλές διαταραχές (αναφερόμενο ως \verb|vidrMult| για την dosage-aware έκδοση και \verb|vidrSingle| για την single-perturbation έκδοση).

Ο στόχος μας είναι να διερευνήσουμε εάν η υπό-συνθήκη-διαμόρφωση του τύπου της διαταραχής, η οποία επιτρέπει προβλέψεις για πολλαπλές διαταραχές και ως συνεπακόλουθο την αξιοποίηση της μάθησης πολλαπλών εργασιών, μπορεί να βελτιώσει την απόδοση στην εργασία της πρόβλεψης εκτός κατανομής \gls{ood}. Επεκτείνουμε την αξιολόγηση σε πολλαπλά βιολογικά πλαίσια, συμπεριλαμβανομένων των κυτταρικών τύπων και διαφορετικών ειδών, για να εκτιμήσουμε την ανθεκτικότητα και τη γενίκευση της μεθόδου.

Χρησιμοποιήσαμε δύο κατηγορίες μετρικών αξιολόγησης για τη σύγκριση των προβλεπόμενων προφίλ γονιδιακής έκφρασης με τα πραγματικά διαταραγμένα: α) βασικές μετρικές και β) μετρικές απόστασης. Οι βασικές μετρικές περιλαμβάνουν τον αριθμό κοινών διαφορετικών εκφραζόμενων γονιδίων (\gls{degs}), τον τετραγωνισμένο συντελεστή Pearson $R^2$ για τα μέσα επίπεδα έκφρασης υπολογισμένα πάνω σε όλα τα γονίδια υψηλής μεταβλητότητας (\gls{hvg}), καθώς και το $R^2$ για τα κορυφαία 100 \gls{hvg}. Ένα διαφοροποιημένο γονίδιο (DEG) ορίζεται ως γονίδιο του οποίου η κατανομή έκφρασης διαφέρει σημαντικά μεταξύ συνθήκης ελέγχου και διαταραχής. Για τον εντοπισμό \gls{degs} χρησιμοποιήσαμε το Scanpy \cite{wolf2018scanpy}, το οποίο εφαρμόζει στατιστικές δοκιμές για την κατάταξη των γονιδίων. Για την καταμέτρηση κοινών \gls{degs} υπολογίζουμε τις κορυφαίες 100 κατατάξεις τόσο για το προβλεπόμενο όσο και για το πραγματικό προφίλ και παίρνουμε την τομή τους.

Οι μετρικές απόστασης καταγράφουν τόσο σημειακές όσο και διαφορές στις κατανομές μεταξύ προβλεπόμενων και πραγματικών προφίλ και περιλαμβάνουν: (α) Ευκλείδεια απόσταση, (β) E-distance, (γ) Wasserstein απόσταση, (δ) mean pairwise distance (MPD) και (ε) maximum mean discrepancy (MMD). Οι βασικές μετρικές (baseline metrics) υπολογίστηκαν με το Scanpy, ενώ οι μετρικές απόστασης υπολογίστηκαν με τη βιβλιοθήκη Pertpy \cite{heumos2024pertpy}.

Για την αντιμετώπιση της τυχαιότητας και της διακύμανσης, επαναλάβαμε κάθε πείραμα τρεις φορές με διαφορετικούς τυχαίους σπόρους (1, 2 και 19193) και υπολογίζουμε τη μέση τιμή της απόδοσης.

Για την παρουσίαση των αποτελεσμάτων που ακολουθεί, επιλέξαμε κάποιες από τις πιο αποδοτικές \gls{mlt} προτεινόμενες αρχιτεκτονικές αυτής της εργασίας (\verb|MTAe|, \verb|MTAeAdv|, \verb|MTAeAdvG|, \verb|MTVae|). Για την πλήρη σύγκριση όλων των μοντέλων, ο αναγνώστης μπορεί να ανατρέξει στο συμπληρωματικό υλικό που παρατίθεται στο \crefwithappendix{sec:appendix_evaluation}.

\subsection{Πρόβλεψη μονοκυτταρικών διαταραχών με μονή διαταραχή}
\label{sec:eval_single_perturbation}
Αξιολογήσαμε τα μοντέλα σε ανθρώπινα \gls{pbmc} που διεγέρθηκαν με \gls{ifnb} (Kang et al. \cite{kanaGenerativeModelingSinglecell2023}). Σε αυτό το σύνολο δεδομένων υπάρχει μόνο ένας τύπος διαταραχής και το σήμα της υπό-συνθήκη-διαμόρφωσης στις \gls{mlt} αρχιτεκτονικές μας είναι ένα one-hot διάνυσμα με δύο θέσεις: μία για την κατάσταση ελέγχου και μία για την κατάσταση διαταραχής. Χρησιμοποιήσαμε τα προεπεξεργασμένα δεδομένα της μελέτης scGen \cite{lotfollahiScGenPredictsSinglecell2019}, που περιλαμβάνουν 18.868 κύτταρα και τις 6.998 πιο μεταβλητές μεταγραφές (\gls{hvg}).

Δοκιμάσαμε τα μοντέλα σε όλους τους τύπους κυττάρων, εκπαιδεύοντας ένα μοντέλο από την αρχή για κάθε περίπτωση (\cref{fig:eval_pbmc,fig:eval_pbmc_distance}). Για την αξιολόγηση κρατήσαμε εκτός (held-out) το διαταραγμένο προφίλ γονιδιακής έκφρασης του υπό εξέταση τύπου κυττάρου και χρησιμοποιήσαμε τα υπόλοιπα για εκπαίδευση.

Συγκρίνοντας τα αποτελέσματα κατά μέσο όρο σε όλους τους τύπους κυττάρων (βλ. \cref{tab:eval_pbmc}), παρατηρούμε ότι μία από τις \gls{mlt} παραλλαγές μας, η μέθοδος \verb|MTAe|, πέτυχε τον υψηλότερο μέσο αριθμό \gls{degs} ($\approx 75$) και παρουσίασε συγκρίσιμα $R^2$ σκορ με τα scVIDR και scButterfly, τα οποία ήταν από τα καλύτερα μοντέλα. Οι μετρικές απόστασης δείχνουν ότι τα scVIDR και scButtergly αποδίδουν καλύτερα από τη \verb|MTAe|, υποδεικνύοντας μια πιο αντιπροσωπευτική συνολική δομή των διαταραγμένων προφίλ γονιδιακής έκφρασης. Ωστόσο, οι \verb|MTAeAdv| και \verb|MTVae| ήταν σε γενικές γραμμές ισοδύναμες με τα κορυφαία μοντέλα σε πολλές μετρικές, ενώ οι παραλλαγές με optimal transport (\verb|MTAeOT|, \verb|MTAePlusOT|, \verb|MTVaeOT|, \verb|MTVaePlusOT|) απέδωσαν χειρότερα με σημαντική διαφορά.

Στο \cref{fig:eval_pbmc_violins} επιλέξαμε το ISG15, έναν γονιδιακό δείκτη  της διαταραχής IFN-β, ως παράδειγμα για την απεικόνιση της κατανομής των προβλεπόμενων και αναμενόμενων προφίλ έκφρασης ανά τύπο κυττάρου. Κανένα από τα μοντέλα δεν αναπαρήγαγε πλήρως την αναμενόμενη κατανομή για αυτό το γονίδιο.

\clearpage


% \begin{figure}
%     \centering
%     \includegraphics[width=\textwidth]{multi_task_benchmarking_cell_type_baseline_metrics_pbmc.png}
%     \caption{Kang et al. \cite{kanaGenerativeModelingSinglecell2023}}
%     \label{fig:pbmc_umap}
% \end{figure}


% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=0.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_pbmc.png}
%     \caption{Βασικές μετρικές ανά τύπο κυττάρου (Kang et al. \cite{kanaGenerativeModelingSinglecell2023})}
%     \label{fig:eval_pbmc}
% \end{figure}

\begin{figure}[h!]
    \centering
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_pbmc_degs.png}
    \caption{\gls{degs}}
    \end{subfigure}
    
    \hfill
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_pbmc_r2all.png}
    \caption{$R^2$ για όλα τα γονίδια}
    \end{subfigure}

    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_pbmc_r220.png}
    \caption{$R^2$ για τα 20 πρώτα \gls{hvg}}
    \end{subfigure}    
\end{figure}


\begin{figure}[h!]\ContinuedFloat
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_pbmc_r2100.png}
    \caption{$R^2$ για τα 100 πρώτα \gls{hvg}}
    \end{subfigure}        
    
    \caption{Βασικές μετρικές ανά τύπο κυττάρου (Kang et al. \cite{kanaGenerativeModelingSinglecell2023})}
    \label{fig:eval_pbmc}
\end{figure}

\begin{figure}[!htbp]
    \centering
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_pbmc_edist.png}
    \caption{edistance}
    \end{subfigure}

    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_pbmc_wasserstein.png}
    \caption{wasserstein}
    \end{subfigure}    
\end{figure}


\begin{figure}[p]\ContinuedFloat
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_pbmc_euclidean.png}
    \caption{euclidean}
    \end{subfigure}  
    
    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_pbmc_mean_pairwise.png}
    \caption{mean pairwise distance}
    \end{subfigure}        

    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_pbmc_mmd.png}
    \caption{mmd}
    \end{subfigure}      
    
    \caption{Μετρικές απόστασης ανά τύπο κυττάρου (Kang et al. \cite{kanaGenerativeModelingSinglecell2023})}
    \label{fig:eval_pbmc_distance}    
\end{figure}

\clearpage


\begin{figure}[h!]
    \centering
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{figures/pbmc_split_cell_type.png}
    \caption{}
    \end{subfigure}
    
    \hfill
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{figures/pbmc_split_condition.png}
    \caption{}
    \end{subfigure}
\end{figure}


\begin{figure}[p]\ContinuedFloat
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{figures/pbmc_split_train.png}
    \caption{}
    \end{subfigure}

    \hfill
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{figures/pbmc_split_test.png}
    \caption{}
    \end{subfigure}        
    
    \caption{Απεικόνιση UMAP του διαχωρισμού των δεδομένων (Kang et al. \cite{kanaGenerativeModelingSinglecell2023})}
    \label{fig:eval_pbmc_umap}
\end{figure}



\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{violins_pbmc.png}
    \caption{Διάγραμμα βιολιού των κατανομών έκφρασης του γονιδίου ISG15 (Kang et al. \cite{kanaGenerativeModelingSinglecell2023})}
    \label{fig:eval_pbmc_violins}
\end{figure}

\begin{table}[h!]
    \centering
    \scalebox{0.75}{
    \begin{tabularx}{\textwidth}{lXXXXXXXXX}
    \toprule
    model & DEGs & $R^2_{\text{HVG}}$ & $R^2_{\text{HVG20}}$ & $R^2_{\text{HVG100}}$ & Euc & Was & E-dist & MPD & MMD \\
    \midrule
    MTAe & \textbf{75.714} & 0.946 & 0.871 & 0.917 & 0.488 & 0.892 & 0.651 & 0.949 & 0.488 \\
    MTAeAdv & 72.381 & 0.961 & 0.955 & 0.948 & 0.202 & 0.604 & 0.429 & 0.800 & 0.202 \\
    MTAeAdvG & 65.905 & 0.917 & 0.878 & 0.901 & 0.504 & 0.828 & 0.681 & 0.909 & 0.504 \\
    MTAeOT & 41.190 & 0.657 & 0.668 & 0.648 & 0.811 & 0.947 & 0.883 & 0.963 & 0.811 \\
    MTAePlusOT & 37.190 & 0.670 & 0.674 & 0.657 & 0.810 & 0.951 & 0.880 & 0.966 & 0.810 \\
    MTVae & 69.095 & 0.942 & 0.954 & 0.928 & 0.261 & 0.621 & 0.499 & 0.800 & 0.261 \\
    MTVaeOT & 39.571 & 0.669 & 0.678 & 0.663 & 0.813 & 0.955 & 0.883 & 0.966 & 0.813 \\
    MTVaePlusOT & 30.619 & 0.661 & 0.670 & 0.655 & 0.821 & 0.958 & 0.888 & 0.968 & 0.821 \\
    scButterfly & 60.727 & 0.891 & 0.914 & 0.889 & 0.271 & \textbf{0.601} & 0.469 & \textbf{0.779} & 0.271 \\
    scGen & 32.143 & 0.910 & 0.872 & 0.870 & 0.627 & 0.909 & 0.765 & 0.946 & 0.627 \\
    scPreGAN & 35.750 & 0.771 & 0.857 & 0.799 & 0.499 & 0.690 & 0.682 & 0.851 & 0.499 \\
    vidrSingle & 25.536 & \textbf{0.970} & \textbf{0.971} & \textbf{0.961} & \textbf{0.182} & 0.606 & \textbf{0.408} & 0.797 & \textbf{0.182} \\
    \bottomrule
    \end{tabularx}}
    \caption{Μέσοι όροι σε όλους τους τύπους κυττάρων (Kang et al. \cite{kanaGenerativeModelingSinglecell2023})}
    \label{tab:eval_pbmc}
\end{table}

\clearpage

\subsection{Πρόβλεψη μονοκυτταρικών διαταραχών με πολλαπλές διαταραχές}
\label{sec:eval_multiple_perturbations}
Όπως αναφέρθηκε στο \crefwithname{sec:eval_single_perturbation}, οι \gls{mlt} αρχιτεκτονικές μας δεν μπόρεσαν να αξιοποιήσουν την κοινή πληροφορία μεταξύ διαταραχών όταν στη διάθεσή τους υπήρχε μόνο μία διαταραχή. Για μια πιο ρεαλιστική αξιολόγηση, δοκιμάσαμε τα μοντέλα στο σύνολο δεδομένων των Nault et al. \cite{nault2021single,nault2022benchmarking}, που περιλαμβάνει έντεκα τύπους κυττάρων εκτεθειμένους σε οκτώ διαφορετικές δοσολογίες \gls{tcdd} σε ποντίκια.

Η προεπεξεργασία του συνόλου δεδομένων έγινε με το Scanpy \cite{wolf2018scanpy}: φιλτράραμε κύτταρα με λιγότερα από 500 συνολικά counts\footnote{Ο όρος "counts" στην βιβλιοθήκη Scanpy μεταφράζεται ως ο ακατέργαστος αριθμός της γονιδιακής έκφρασης των κυττάρων (raw gene expression values)} και λιγότερα από 720 εκφραζόμενα γονίδια, καθώς και γονίδια που εκφράζονται σε λιγότερα από 100 κύτταρα. Τα δεδομένα μετασχηματίστηκαν λογαριθμικά για πιο σταθερή εκπαίδευση και επιλέχθηκαν οι 5.000 πιο μεταβλητές μεταγραφές (\gls{hvg}).

Κάθε επίπεδο δοσολογίας αντιμετωπίστηκε ως ξεχωριστή διαταραχή, με την κατάσταση ελέγχου ως σημείο αναφοράς. Το \gls{condsignal} για τις \gls{mlt} αρχιτεκτονικές είναι ένα one-hot διάνυσμα με εννέα διαστάσεις: ένα στοιχείο για καθεμία από τις οκτώ δοσολογίες και ένα για την κατάσταση ελέγχου. Για την αξιολόγηση, εκπαιδεύσαμε ξεχωριστό μοντέλο ανά τύπο κυττάρου, κρατώντας εκτός τα διαταραγμένα προφίλ του τύπου αυτού για  δοκιμή (testing). Το ίδιο μοντέλο χρησιμοποιήθηκε για προβλέψεις σε όλες τις δοσολογίες, εκμεταλλευόμενο την ικανότητα της \glslink{conditioning}{υπό-συνθήκη-διαμόρφωσης} στην ταυτότητα της διαταραχής.

Αντίθετα, τα μοντέλα αναφοράς (baseline) που δεν υποστηρίζουν υπό-συνθήκη-διαμόρφωση σε πολλαπλές διαταραχές προϋποθέτουν την εκπαίδευση ξεχωριστού μοντέλου για κάθε δοσολογία. Εξαίρεση αποτελεί το scVIDR, που σχεδιάστηκε για να χειρίζεται πολλαπλά επίπεδα δοσολογίας μέσα σε ένα ενιαίο μοντέλο.

Συνοψίζοντας τα αποτελέσματα κατά μέσο όρο σε όλους τους τύπους κυττάρων και δοσολογιών (βλ. \cref{tab:eval_nault}), όπως και στην περίπτωση της μονής διαταραχής (\crefwithname{sec:eval_single_perturbation}), διαπιστώσαμε ότι το \gls{mlt} μοντέλο \verb|MTAe| πέτυχε τον υψηλότερο μέσο αριθμό \gls{degs} ($\approx 20$). Το scGen εμφάνισε τα υψηλότερα $R^2$ σκορ αλλά με πολύ χαμηλό αριθμό \gls{degs}, ενώ το scButterfly παρέμεινε ανταγωνιστικό σε όλες τις μετρικές. Οι παραλλαγές με optimal transport αποδείχθηκαν ικανές στις μετρικές απόστασης αλλά ασθενείς στις βασικές μετρικές (baseline metrics).

\clearpage

\begin{figure}[h!]
    \centering
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_nault_degs.png}
    \caption{\gls{degs}}
    \end{subfigure}
    
    \hfill
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_nault_r2all.png}
    \caption{$R^2$ για όλα τα γονίδια}
    \end{subfigure}

    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_nault_r220.png}
    \caption{$R^2$ για τα 20 πρώτα \gls{hvg}}
    \end{subfigure}    
\end{figure}


\begin{figure}[h!]\ContinuedFloat
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_nault_r2100.png}
    \caption{$R^2$ για τα 100 πρώτα \gls{hvg}}
    \end{subfigure}        
    
    \caption{Βασικές μετρικές ανά τύπο κυττάρου (Nault et al. \cite{nault2021single,nault2022benchmarking})}
    \label{fig:eval_nault}
\end{figure}

\begin{figure}[!htbp]
    \centering
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_nault_edist.png}
    \caption{edistance}
    \end{subfigure}

    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_nault_wasserstein.png}
    \caption{wasserstein}
    \end{subfigure}    
\end{figure}


\begin{figure}[p]\ContinuedFloat
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_nault_euclidean.png}
    \caption{euclidean}
    \end{subfigure}  
    
    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_nault_mean_pairwise.png}
    \caption{mean pairwise distance}
    \end{subfigure}        

    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_nault_mmd.png}
    \caption{mmd}
    \end{subfigure}      
    
    \caption{Μετρικές απόστασης ανά τύπο κυττάρου (Nault et al. \cite{nault2021single,nault2022benchmarking})}
    \label{fig:eval_nault_distance} 
\end{figure}



% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=0.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_nault_degs.png}
%     \caption{Βασικές μετρικές ανά τύπο κυττάρου (Nault et al. \cite{nault2021single,nault2022benchmarking})}
%     \label{fig:eval_nault}
% \end{figure}

% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=0.88\textwidth]{selected_benchmarking_cell_type_distance_metrics_nault.png}
%     \caption{Μετρικές απόστασης ανά τύπο κυττάρου (Nault et al. \cite{nault2021single,nault2022benchmarking})}
%     \label{fig:eval_nault_distance}
% \end{figure}


\begin{figure}[h!]
    \centering
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_dose_baseline_metrics_nault_degs.png}
    \caption{\gls{degs}}
    \end{subfigure}
    
    \hfill
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_dose_baseline_metrics_nault_r2all.png}
    \caption{$R^2$ για όλα τα γονίδια}
    \end{subfigure}

    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_dose_baseline_metrics_nault_r220.png}
    \caption{$R^2$ για τα 20 πρώτα \gls{hvg}}
    \end{subfigure}    
\end{figure}


\begin{figure}[h!]\ContinuedFloat
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_dose_baseline_metrics_nault_r2100.png}
    \caption{$R^2$ για τα 100 πρώτα \gls{hvg}}
    \end{subfigure}        
    
    \caption{Βασικές μετρικές ανά δοσολογία (Nault et al. \cite{nault2021single,nault2022benchmarking})}
    \label{fig:eval_nault_doses_baseline}
\end{figure}

\begin{figure}[!htbp]
    \centering
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_dose_distance_metrics_nault_edist.png}
    \caption{edistance}
    \end{subfigure}

    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_dose_distance_metrics_nault_wasserstein.png}
    \caption{wasserstein}
    \end{subfigure}    
\end{figure}


\begin{figure}[p]\ContinuedFloat
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_dose_distance_metrics_nault_euclidean.png}
    \caption{euclidean}
    \end{subfigure}  
    
    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_dose_distance_metrics_nault_mean_pairwise.png}
    \caption{mean pairwise distance}
    \end{subfigure}        

    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_dose_distance_metrics_nault_mmd.png}
    \caption{mmd}
    \end{subfigure}      
    
    \caption{Μετρικές απόστασης ανά δοσολογία (Nault et al. \cite{nault2021single,nault2022benchmarking})}
    \label{fig:eval_nault_doses_distance}
\end{figure}

\clearpage



% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=0.9\textwidth]{selected_benchmarking_doses_baseline_metrics_nault.png}
%     \caption{Βασικές μετρικές ανά δοσολογία (Nault et al. \cite{nault2021single,nault2022benchmarking})}
%     \label{fig:eval_nault_doses_baseline}
% \end{figure}

% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=0.9\textwidth]{selected_benchmarking_doses_distance_metrics_nault.png}
%     \caption{Μετρικές απόστασης ανά δοσολογία (Nault et al. \cite{nault2021single,nault2022benchmarking})}
%     \label{fig:eval_nault_doses_distance}
% \end{figure}

\begin{figure}[h!]
    \centering
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{figures/nault_umap_split_multiple_cell_type.png}
    \caption{}
    \end{subfigure}
    
    \hfill
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{figures/nault_umap_split_multiple_condition.png}
    \caption{}
    \end{subfigure}
\end{figure}


\begin{figure}[p]\ContinuedFloat
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{figures/nault_umap_split_multiple_train.png}
    \caption{}
    \end{subfigure}

    \hfill
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{figures/nault_umap_split_multiple_test.png}
    \caption{}
    \end{subfigure}        
    
    \caption{Απεικόνιση UMAP του διαχωρισμού των δεδομένων για όλες τις δοσολογίες (Nault et al. \cite{nault2021single,nault2022benchmarking})}
    \label{fig:eval_nault_umap_all}
\end{figure}

% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=0.85\textwidth]{figures/nault_umap_split_multiple.png}
%     \caption{Απεικόνιση UMAP του διαχωρισμού των δεδομένων για όλες τις δοσολογίες (Nault et al. \cite{nault2021single,nault2022benchmarking})}
%     \label{fig:eval_nault_umap_all}
% \end{figure}

\begin{figure}[h!]
    \centering
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{figures/nault_umap_split_30_cell_type.png}
    \caption{}
    \end{subfigure}
    
    \hfill
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{figures/nault_umap_split_30_condition.png}
    \caption{}
    \end{subfigure}
\end{figure}


\begin{figure}[p]\ContinuedFloat
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{figures/nault_umap_split_30_train.png}
    \caption{}
    \end{subfigure}

    \hfill
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{figures/nault_umap_split_30_test.png}
    \caption{}
    \end{subfigure}        
    
    \caption{Απεικόνιση UMAP του διαχωρισμού των δεδομένων για τη δοσολογία $30 \mu g/kg$ (Nault et al. \cite{nault2021single,nault2022benchmarking})}
    \label{fig:eval_nault_umap_30}
\end{figure}

% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=0.85\textwidth]{figures/nault_umap_split_30.png}
%     \caption{Απεικόνιση UMAP του διαχωρισμού των δεδομένων για τη δοσολογία $30 \mu g/kg$ (Nault et al. \cite{nault2021single,nault2022benchmarking})}
%     \label{fig:eval_nault_umap_30}
% \end{figure}


\begin{table}[h!]
    \centering
    \scalebox{0.75}{
    \begin{tabularx}{\textwidth}{lXXXXXXXXX}
    \toprule
    model & DEGs & $R^2_{\text{HVG}}$ & $R^2_{\text{HVG20}}$ & $R^2_{\text{HVG100}}$ & Euc & Was & E-dist & MPD & MMD \\
    \midrule
    MTAe & \textbf{20.341} & 0.862 & 0.792 & 0.833 & 1.386 & 1.217 & 1.116 & 1.050 & 1.386 \\
    MTAeAdv & 13.716 & 0.792 & 0.725 & 0.743 & 1.128 & 1.091 & 1.011 & 1.017 & 1.128 \\
    MTAeAdvG & 18.307 & 0.808 & 0.736 & 0.764 & 1.164 & 1.107 & 1.030 & 1.029 & 1.164 \\
    MTAeOT & 8.652 & 0.608 & 0.642 & 0.590 & 0.925 & 1.006 & 0.951 & 0.998 & 0.925 \\
    MTAePlusOT & 8.519 & 0.613 & 0.644 & 0.596 & \textbf{0.917} & \textbf{1.004} & 0.948 & 0.996 & 0.917 \\
    MTVae & 18.981 & 0.808 & 0.724 & 0.753 & 1.124 & 1.100 & 1.005 & 1.016 & 1.124 \\
    MTVaeOT & 8.163 & 0.614 & 0.642 & 0.593 & 0.929 & 1.009 & 0.952 & 0.998 & 0.929 \\
    MTVaePlusOT & 8.701 & 0.615 & 0.645 & 0.597 & 0.919 & 1.006 & 0.948 & 0.997 & \textbf{0.919} \\
    scButterfly & 16.818 & 0.740 & 0.694 & 0.696 & 0.984 & 1.014 & \textbf{0.944} & \textbf{0.990} & 0.984 \\
    scGen & 6.288 & \textbf{0.915} & \textbf{0.863} & \textbf{0.897} & 2.408 & 1.229 & 1.387 & 1.041 & 2.408 \\
    scPreGAN & 14.511 & 0.599 & 0.596 & 0.562 & 0.972 & 1.019 & 0.969 & 1.000 & 0.972 \\
    vidrMult & 2.352 & 0.870 & 0.837 & 0.852 & 9.295 & 1.358 & 2.425 & 1.054 & 9.295 \\
    vidrSingle & 3.795 & 0.855 & 0.797 & 0.824 & 1.431 & 1.174 & 1.118 & 1.025 & 1.431 \\
    \bottomrule
    \end{tabularx}}
    \caption{Μέσοι όροι σε όλους τους τύπους κυττάρων Nault et al. \cite{nault2021single,nault2022benchmarking}}
    \label{tab:eval_nault}
\end{table}



% \subsection{Cross-study}

% Robustness against batch effects is a critical aspect of generalization. To evaluate this, we assessed model performance across multiple studies, each potentially introducing technical variation due to differences in experimental protocols, platforms, or sample processing. This cross-study evaluation serves to test the ability of the models to generalize perturbation response predictions beyond dataset-specific biases. To implement this, similarly with the scGen's study, By holding out the perturbed profiles of a given study during training and evaluating the model on that study, we simulate an \gls{ood} setting with respect to study-level batch effects, thereby assessing the robustness and transferability of each approach across independently generated datasets.

\subsection{Πρόβλεψη μονοκυτταρικών διαταραχών μεταξύ ειδών}
\label{sec:eval_cross_species}


Μέχρι τώρα ο κύριος άξονας μεταβλητότητας για την αξιολόγηση της απόδοσης των μοντέλων ήταν η συνθήκη (control vs perturbed). Για να αξιολογήσουμε περαιτέρω την ανθεκτικότητα και τη γενίκευση των \gls{mlt} αρχιτεκτονικών, εισάγουμε έναν επιπλέον άξονα μεταβλητότητας: το είδος (species).

Παρόμοια με την προσέγγιση της μελέτης scGen, χρησιμοποιήσαμε το σύνολο δεδομένων των Hagai et al. \cite{hagai2018gene}, το οποίο περιλαμβάνει μονοπύρηνους φαγοκύττες προερχόμενους από τον μυελό των οστών τεσσάρων ειδών (ποντίκι, αρουραίο, κουνέλι και χοίρο), όλα υπό διέγερση με λιποπολυσακχαρίτη (\gls{lps}) για έξι ώρες.

Το σύνολο δεδομένων λήφθηκε προεπεξεργασμένο από τη μελέτη scGen. Για την αξιολόγηση ακολουθήσαμε την ίδια διαδικασία όπως στο \crefwithname{sec:eval_single_perturbation}, αλλά αντί να κρατήσουμε εκτός τα διαταραγμένα προφίλ ενός τύπου κυττάρου, κρατήσαμε εκτός τα διαταραγμένα προφίλ ενός είδους.

Συνοψίζοντας τα αποτελέσματα κατά μέσο όρο για όλα τα είδη (βλ. \cref{tab:eval_cross_species}), παρατηρήθηκε ότι η \verb|MTAe| πέτυχε τον υψηλότερο μέσο αριθμό \gls{degs} ($\approx 16$). Τα scGen και scVIDR πέτυχαν τα υψηλότερα $R^2$ σκορ, όπως και στην περίπτωση της μονής διαταραχής (\crefwithname{sec:eval_single_perturbation}), αλλά είχαν χαμηλή απόδοση στις μετρικές απόστασης. Η \verb|MTVae| κατέγραψε την καλύτερη απόδοση στις μετρικές απόστασης και σχετικά υψηλό αριθμό \gls{degs} ($\approx 12.5$), αλλά χαμηλά $R^2$. Οι παραλλαγές με optimal transport ανταποκρίθηκαν ικανοποιητικά στις μετρικές απόστασης, αλλά ασθενώς στις μετρικές αναφοράς, όπως και στο προηγούμενο σύνολο δεδομένων.


\clearpage



\begin{figure}[h!]
    \centering
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_cross_species_degs.png}
    \caption{\gls{degs}}
    \end{subfigure}
    
    \hfill
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_cross_species_r2all.png}
    \caption{$R^2$ για όλα τα γονίδια}
    \end{subfigure}

    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_cross_species_r220.png}
    \caption{$R^2$ για τα 20 πρώτα \gls{hvg}}
    \end{subfigure}    
\end{figure}


\begin{figure}[h!]\ContinuedFloat
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_cross_species_r2100.png}
    \caption{$R^2$ για τα 100 πρώτα \gls{hvg}}
    \end{subfigure}        
    
    \caption{Βασικές μετρικές ανά είδος (Hagai et al. \cite{hagai2018gene})}
    \label{fig:eval_cross_species}
\end{figure}

\begin{figure}[!htbp]
    \centering
    
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_cross_species_edist.png}
    \caption{edistance}
    \end{subfigure}

    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_cross_species_wasserstein.png}
    \caption{wasserstein}
    \end{subfigure}    
\end{figure}


\begin{figure}[p]\ContinuedFloat
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_cross_species_euclidean.png}
    \caption{euclidean}
    \end{subfigure}  
    
    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_cross_species_mean_pairwise.png}
    \caption{mean pairwise distance}
    \end{subfigure}        

    \hfill

    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=.83\textwidth]{selected_benchmarking_cell_type_distance_metrics_cross_species_mmd.png}
    \caption{mmd}
    \end{subfigure}      
    
    \caption{Μετρικές απόστασης ανά είδος (Hagai et al. \cite{hagai2018gene})}
    \label{fig:eval_cross_species_distance}
\end{figure}

% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=0.9\textwidth]{selected_benchmarking_cell_type_baseline_metrics_cross_species.png}
%     \caption{Βασικές μετρικές ανά είδος (Hagai et al. \cite{hagai2018gene})}
%     \label{fig:eval_cross_species}
% \end{figure}

% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=0.9\textwidth]{selected_benchmarking_cell_type_distance_metrics_cross_species.png}
%     \caption{Μετρικές απόστασης ανά είδος (Hagai et al. \cite{hagai2018gene})}
%     \label{fig:eval_cross_species_distance}
% \end{figure}

\clearpage

\begin{table}[h!]
    \centering    
    \scalebox{0.75}{
    \begin{tabularx}{\textwidth}{lXXXXXXXXX}
    \toprule
    model & DEGs & $R^2_{\text{HVG}}$ & $R^2_{\text{HVG20}}$ & $R^2_{\text{HVG100}}$ & Euc & Was & E-dist & MPD & MMD \\
    \midrule
    MTAe & \textbf{16.083} & 0.740 & 0.559 & 0.481 & 0.930 & 1.008 & 0.962 & 0.995 & 0.930 \\
    MTAeAdv & 11.250 & 0.579 & 0.465 & 0.365 & 0.865 & 0.919 & 0.929 & 0.957 & 0.865 \\
    MTAeAdvG & 12.500 & 0.708 & 0.533 & 0.456 & 0.921 & 0.985 & 0.958 & 0.987 & 0.921 \\
    MTAeOT & 7.500 & 0.483 & 0.432 & 0.304 & 0.899 & 0.932 & 0.948 & 0.966 & 0.899 \\
    MTAePlusOT & 8.000 & 0.480 & 0.436 & 0.309 & 0.876 & 0.913 & 0.936 & 0.956 & 0.876 \\
    MTVae & 12.500 & 0.652 & 0.498 & 0.413 & \textbf{0.840} & \textbf{0.903} & \textbf{0.916} & \textbf{0.951} & 0.840 \\
    MTVaeOT & 7.417 & 0.479 & 0.423 & 0.302 & 0.895 & 0.929 & 0.946 & 0.964 & 0.895 \\
    MTVaePlusOT & 7.833 & 0.473 & 0.431 & 0.301 & 0.883 & 0.919 & 0.940 & 0.959 & 0.883 \\
    scButterfly & 10.750 & 0.574 & 0.389 & 0.346 & 0.899 & 0.942 & 0.948 & 0.971 & 0.899 \\
    scGen & 7.583 & 0.826 & 0.705 & 0.658 & 2.014 & 1.576 & 1.367 & 1.165 & 2.014 \\
    scPreGAN & 7.250 & 0.443 & 0.374 & 0.276 & 0.914 & 0.945 & 0.955 & 0.973 & 0.914 \\
    vidrSingle & 12.917 & \textbf{0.878} & \textbf{0.711} & \textbf{0.701} & 3.386 & 1.905 & 1.769 & 1.225 & 3.386 \\
    \bottomrule
    \end{tabularx}}
    \caption{Μέσοι όροι σε όλους τους τύπους κυττάρων Hagel et al. \cite{hagai2018gene}}
    \label{tab:eval_cross_species}
\end{table}


% \subsection{Overview}

% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=\textwidth]{pcas.png}
%     \caption{PCA dimensionality reduction of the real unperturbed data, the real perturbed data and the predicted perturbed data.}
%     \label{fig:selected_nault_cell_type_baseline}
% \end{figure}

% scVIDR performance drops for DEGs, and distance metrics, but it performs well for the $R^2$ metrics and stays very consistent, along with scGEN. The \gls{mlt} models and scButterfly exhibit greater variability across measurements, but better performance on average. The optimal transport variations performed poorly overall, but were among the best for distance metrics for the Nault et al. \cite{nault2021single,nault2022benchmarking} dataset. 


\clearpage

\section{Συμπεράσματα και μελλοντικές ερευνητικές προεκτάσεις}

Στην παρούσα εργασία προτείναμε μια πρωτότυπη αρχιτεκτονική μάθησης πολλαπλών εργασιών για τη μοντελοποίηση διαταραχών σε μονοκυτταρικά μεταγραφωμικά δεδομένα (\gls{sc}), ικανή να πραγματοποιήσει \gls{conditioning} στον τύπο της διαταραχής. Ο σχεδιασμός αυτός επιτρέπει στο μοντέλο να αξιοποιεί κοινή πληροφορία μεταξύ διαφορετικών διαταραχών, οδηγώντας σε βελτίωση της απόδοσης στην εργασία πρόβλεψης εκτός κατανομής (\gls{ood}). Συγκρίναμε τα μοντέλα μας με τρέχουσες \glslink{sota}{μεθόδους αιχμής}, όπως τα scGen, scVIDR, scPreGAN και scButterfly.

Επιπλέον, επιβεβαιώσαμε την προοπτική του scButterfly για τη μοντελοποίηση διαταραχών στο dataset πολλαπλών δοσολογιών των Nault et al. \cite{nault2021single,nault2022benchmarking}, επεκτείνοντας την αξιολόγηση πέρα από το σύνολο δεδομένων των Kang et al. \cite{kanaGenerativeModelingSinglecell2023} που χρησιμοποιήθηκε στην αρχική μελέτη.

Το βασικό μας μοντέλο, \verb|MTAe|, πέτυχε τον μεγαλύτερο αριθμό \gls{degs} σε όλα τα πειράματα (\crefwithname{sec:eval_single_perturbation}, \crefwithname{sec:eval_multiple_perturbations} και \crefwithname{sec:eval_cross_species}). Αν και κανένα μεμονωμένο μοντέλο δεν υπερέχει σταθερά σε όλες τις μετρικές, ένα σημαντικό πλεονέκτημα της \gls{mlt} προσέγγισης είναι η χαμηλότερη πολυπλοκότητα και η καλύτερη κλιμάκωση. Η μέθοδος απαιτεί την εκπαίδευση ενός μόνο μοντέλου ανά τύπο κυττάρου αντί για ένα μοντέλο ανά διαταραχή, όπως συμβαίνει στα μοντέλα αναφοράς \cite{allenspach2024neural}. Αυτό καθιστά την προσέγγισή μας ιδιαίτερα συμφέρουσα για μεγάλα σύνολα δεδομένων με πολλές διαταραχές, μειώνοντας τόσο το υπολογιστικό κόστος όσο και τον χρόνο εκπαίδευσης. Μελλοντική εργασία θα μπορούσε να επικυρώσει περαιτέρω αυτή την αποδοτικότητα παραμέτρων, εφαρμόζοντας την αρχιτεκτονική σε μεγαλύτερα και πιο ποικίλα σύνολα δεδομένων.

Μια περιορισμένη πτυχή της μεθόδου μας είναι ο transductive χαρακτήρας της όσον αφορά τις διαταραχές. Εφόσον το σήμα διαταραχής κωδικοποιείται ως one-hot, το μοντέλο δεν μπορεί να γενικεύσει σε μη-παρατηρημένες διαταραχές. Μελλοντικές έρευνες θα πρέπει να εξετάσουν την ενσωμάτωση επαγωγικών (inductive) αναπαραστάσεων των διαταραχών στην αρχιτεκτονική μας, ώστε να επιτραπεί η γενίκευση σε νέες, μη-παρατηρημένες διαταραχές.

Τελική πρόταση μας είναι η περαιτέρω διερεύνηση και διαμόρφωση της προτεινόμενης αρχιτεκτονικής ως θεωρητικού και αφηρημένου μοντέλου, το οποίο θα στοχεύει στην ταυτόχρονη επίλυση πολλαπλών συναφών προβλημάτων στο πεδίο της μοντελοποίησης διαταραχών και της βιοπληροφορικής ευρύτερα.

% we could explore to apply a combination of perturbations as well

\clearpage

\section{Διαθεσιμότητα κώδικα}

Ο κώδικας που αναπτύχθηκε για τα μοντέλα και τα πειράματα είναι διαθέσιμος στη διεύθυνση: \url{https://github.com/thodkatz/thesis}.

\clearpage

\renewcommand\refname{Βιβλιογραφία}
\addcontentsline{toc}{section}{Βιβλιογραφία}
\bibliographystyle{plain}
\bibliography{../references.bib}

\clearpage


\addcontentsline{toc}{section}{Παράρτημα}
\section*{Παράρτημα}


\addcontentsline{toc}{subsection}{Πρόσθετη αξιολόγηση των αρχιτεκτονικών με μάθηση πολλαπλών εργασιών}
\subsection*{Πρόσθετη αξιολόγηση των αρχιτεκτονικών με μάθηση πολλαπλών εργασιών}
\label{sec:appendix_evaluation}

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.77\textwidth]{multi_task_benchmarking_cell_type_baseline_metrics_pbmc.png}
    \caption{Βασικές μετρικές ανά τύπο κυττάρου (Kang et al. \cite{kang2018multiplexed})}
    \label{fig:all_multi_task_kang}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.77\textwidth]{multi_task_benchmarking_cell_type_distance_metrics_pbmc.png}
    \caption{Μετρικές απόστασης ανά τύπο κυττάρου (Kang et al. \cite{kang2018multiplexed})}
    \label{fig:all_multi_task_kang_distance}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{multi_task_benchmarking_cell_type_baseline_metrics_nault.png}
    \caption{Βασικές μετρικές ανά τύπο κυττάρου (Nault et al. \cite{nault2021single,nault2022benchmarking})}
    \label{fig:all_multi_task_nault}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{multi_task_benchmarking_cell_type_distance_metrics_nault.png}
    \caption{Μετρικές απόστασης ανά τύπο κυττάρου (Nault et al. \cite{nault2021single,nault2022benchmarking})}
    \label{fig:all_multi_task_nault_distance}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{multi_task_benchmarking_doses_baseline_metrics_nault.png}
    \caption{Βασικές μετρικές ανά δοσολογία (Nault et al. \cite{nault2021single,nault2022benchmarking})}
    \label{fig:all_multi_task_nault_doses_baseline}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{multi_task_benchmarking_doses_distance_metrics_nault.png}
    \caption{Μετρικές απόστασης ανά δοσολογία (Nault et al. \cite{nault2021single,nault2022benchmarking})}
    \label{fig:all_multi_task_nault_doses_distance}
\end{figure}

\printglossary[title={Γλωσσάρι}]
\addcontentsline{toc}{section}{Γλωσσάρι}

\end{document}